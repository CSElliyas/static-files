"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(n,r){var e,t,u,o;for(void 0===r&&(r=15),u=.5,e=new Date;;){for(u*=2,o=u;o>3;o-=4)n(),n(),n(),n();for(;o>0;)n(),o--;if((t=new Date)-e>r)break}for(o=u;o>3;o-=4)n(),n(),n(),n();for(;o>0;)n(),o--;return 1e3*(3*u-1)/((t=new Date)-e)},numeric._myIndexOf=function(n){var r,e=this.length;for(r=0;r<e;++r)if(this[r]===n)return r;return -1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(n){function r(n){if(0===n)return"0";if(isNaN(n))return"NaN";if(n<0)return"-"+r(-n);if(isFinite(n)){var e=Math.floor(Math.log(n)/Math.log(10)),t=n/Math.pow(10,e),u=t.toPrecision(numeric.precision);return 10===parseFloat(u)&&(e++,u=(t=1).toPrecision(numeric.precision)),parseFloat(u).toString()+"e"+e.toString()}return"Infinity"}function e(n){if(void 0===n)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return t.push('"'+n+'"'),!1;if("boolean"==typeof n)return t.push(n.toString()),!1;if("number"==typeof n){var u,o=r(n),c=n.toPrecision(numeric.precision),_=parseFloat(n.toString()).toString(),a=[o,c,_,parseFloat(c).toString(),parseFloat(_).toString()];for(u=1;u<a.length;u++)a[u].length<o.length&&(o=a[u]);return t.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===n)return t.push("null"),!1;if("function"==typeof n){t.push(n.toString());var f=!1;for(u in n)n.hasOwnProperty(u)&&(f?t.push(",\n"):t.push("\n{"),f=!0,t.push(u),t.push(": \n"),e(n[u]));return f&&t.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return t.push("...Large Array..."),!0;var f=!1;for(t.push("["),u=0;u<n.length;u++)u>0&&(t.push(","),f&&t.push("\n ")),f=e(n[u]);return t.push("]"),!0}t.push("{");var f=!1;for(u in n)n.hasOwnProperty(u)&&(f&&t.push(",\n"),f=!0,t.push(u),t.push(": \n"),e(n[u]));return t.push("}"),!0}var t=[];return e(n),t.join("")},numeric.parseDate=function(n){function r(n){if("string"==typeof n)return Date.parse(n.replace(/-/g,"/"));if(n instanceof Array){var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}throw Error("parseDate: parameter must be arrays of strings")}return r(n)},numeric.parseFloat=function(n){function r(n){if("string"==typeof n)return parseFloat(n);if(n instanceof Array){var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}throw Error("parseFloat: parameter must be arrays of strings")}return r(n)},numeric.parseCSV=function(n){var r,e,t=n.split("\n"),u=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,c=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,_=function(n){return n.substr(0,n.length-1)},a=0;for(e=0;e<t.length;e++){var f,$=(t[e]+",").match(o);if($.length>0){for(r=0,u[a]=[];r<$.length;r++)f=_($[r]),c.test(f)?u[a][r]=parseFloat(f):u[a][r]=f;a++}}return u},numeric.toCSV=function(n){var r,e,t,u,o,c,_=numeric.dim(n);for(t=_[0],u=_[1],c=[],r=0;r<t;r++){for(e=0,o=[];e<t;e++)o[e]=n[r][e].toString();c[r]=o.join(", ")}return c.join("\n")+"\n"},numeric.getURL=function(n){var r=new XMLHttpRequest;return r.open("GET",n,!1),r.send(),r},numeric.imageURL=function(n){function r(n){var r,e,t,u,o,c,_,a,f=n.length,$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(r=0;r<f;r+=3)e=n[r],t=n[r+1],u=n[r+2],o=e>>2,c=((3&e)<<4)+(t>>4),_=((15&t)<<2)+(u>>6),a=63&u,r+1>=f?_=a=64:r+2>=f&&(a=64),s+=$.charAt(o)+$.charAt(c)+$.charAt(_)+$.charAt(a);return s}function e(n,r,e){void 0===r&&(r=0),void 0===e&&(e=n.length);var t,u=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,c=0;for(n.length,t=r;t<e;t++)c=(o^n[t])&255,o=o>>>8^u[c];return -1^o}var t,u,o,c,_,a,f,$,s,m,l=n[0].length,h=n[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,l>>24&255,l>>16&255,l>>8&255,255&l,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=e(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,t=1,u=0,f=0;f<l;f++){for(f<l-1?p.push(0):p.push(1),_=3*h+1+(0===f)&255,a=3*h+1+(0===f)>>8&255,p.push(_),p.push(a),p.push(255&~_),p.push(255&~a),0===f&&p.push(0),$=0;$<h;$++)for(o=0;o<3;o++)u=(u+(t=(t+(_=(_=n[o][f][$])>255?255:_<0?0:Math.round(_)))%65521))%65521,p.push(_);p.push(0)}return s=(u<<16)+t,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),c=p.length-41,p[33]=c>>24&255,p[34]=c>>16&255,p[35]=c>>8&255,p[36]=255&c,m=e(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+r(p)},numeric._dim=function(n){for(var r=[];"object"==typeof n;)r.push(n.length),n=n[0];return r},numeric.dim=function(n){var r,e;return"object"==typeof n?"object"==typeof(r=n[0])?"object"==typeof(e=r[0])?numeric._dim(n):[n.length,r.length]:[n.length]:[]},numeric.mapreduce=function(n,r){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+';\nif(typeof x === "number") { var xi = x; '+n+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+n+";\n    xi = x[i-1];\n    "+n+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+n+"\n}\nreturn accum;")},numeric.mapreduce2=function(n,r){return Function("x","var n = x.length;\nvar i,xi;\n"+r+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+n+";\n}\nreturn accum;")},numeric.same=function n(r,e){var t,u;if(r instanceof Array&&e instanceof Array){if((u=r.length)!==e.length)return!1;for(t=0;t<u;t++)if(r[t]!==e[t]&&("object"!=typeof r[t]||!n(r[t],e[t])))return!1;return!0}return!1},numeric.rep=function(n,r,e){void 0===e&&(e=0);var t,u=n[e],o=Array(u);if(e===n.length-1){for(t=u-2;t>=0;t-=2)o[t+1]=r,o[t]=r;return -1===t&&(o[0]=r),o}for(t=u-1;t>=0;t--)o[t]=numeric.rep(n,r,e+1);return o},numeric.dotMMsmall=function(n,r){var e,t,u,o,c,_,a,f,$,s,m;for(o=n.length,c=r.length,_=r[0].length,a=Array(o),e=o-1;e>=0;e--){for(f=Array(_),$=n[e],u=_-1;u>=0;u--){for(s=$[c-1]*r[c-1][u],t=c-2;t>=1;t-=2)m=t-1,s+=$[t]*r[t][u]+$[m]*r[m][u];0===t&&(s+=$[0]*r[0][u]),f[u]=s}a[e]=f}return a},numeric._getCol=function(n,r,e){var t,u=n.length;for(t=u-1;t>0;--t)e[t]=n[t][r],e[--t]=n[t][r];0===t&&(e[0]=n[0][r])},numeric.dotMMbig=function(n,r){var e,t,u,o,c=numeric._getCol,_=r.length,a=Array(_),f=n.length,$=r[0].length,s=Array(f),m=numeric.dotVV;for(--_,t=--f;-1!==t;--t)s[t]=Array($);for(t=--$;-1!==t;--t)for(c(r,t,a),u=f;-1!==u;--u)o=0,e=n[u],s[u][t]=m(e,a);return s},numeric.dotMV=function(n,r){var e,t=n.length,u=(r.length,Array(t)),o=numeric.dotVV;for(e=t-1;e>=0;e--)u[e]=o(n[e],r);return u},numeric.dotVM=function(n,r){var e,t,u,o,c,_,a;for(u=n.length,c=Array(o=r[0].length),t=o-1;t>=0;t--){for(_=n[u-1]*r[u-1][t],e=u-2;e>=1;e-=2)a=e-1,_+=n[e]*r[e][t]+n[a]*r[a][t];0===e&&(_+=n[0]*r[0][t]),c[t]=_}return c},numeric.dotVV=function(n,r){var e,t,u=n.length,o=n[u-1]*r[u-1];for(e=u-2;e>=1;e-=2)t=e-1,o+=n[e]*r[e]+n[t]*r[t];return 0===e&&(o+=n[0]*r[0]),o},numeric.dot=function(n,r){var e=numeric.dim;switch(1e3*e(n).length+e(r).length){case 2002:return r.length<10?numeric.dotMMsmall(n,r):numeric.dotMMbig(n,r);case 2001:return numeric.dotMV(n,r);case 1002:return numeric.dotVM(n,r);case 1001:return numeric.dotVV(n,r);case 1e3:return numeric.mulVS(n,r);case 1:return numeric.mulSV(n,r);case 0:return n*r;default:throw Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(n){var r,e,t,u,o=n.length,c=Array(o);for(r=o-1;r>=0;r--){for(u=Array(o),e=r+2,t=o-1;t>=e;t-=2)u[t]=0,u[t-1]=0;for(t>r&&(u[t]=0),u[r]=n[r],t=r-1;t>=1;t-=2)u[t]=0,u[t-1]=0;0===t&&(u[0]=0),c[r]=u}return c},numeric.getDiag=function(n){var r,e=Math.min(n.length,n[0].length),t=Array(e);for(r=e-1;r>=1;--r)t[r]=n[r][r],t[--r]=n[r][r];return 0===r&&(t[0]=n[0][0]),t},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(n,r,e){void 0===e&&(e="");var t,u,o=[],c=/\[i\]$/,_="",a=!1;for(t=0;t<n.length;t++)c.test(n[t])?_=u=n[t].substring(0,n[t].length-3):u=n[t],"ret"===u&&(a=!0),o.push(u);return o[n.length]="_s",o[n.length+1]="_k",o[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+_+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(a?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+n.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+r+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(n,r,e){void 0===e&&(e="");var t,u,o=[],c=/\[i\]$/,_="",a=!1;for(t=0;t<n.length;t++)c.test(n[t])?_=u=n[t].substring(0,n[t].length-3):u=n[t],"ret"===u&&(a=!0),o.push(u);return o[n.length]="var _n = "+_+".length;\nvar i"+(a?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+r+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function n(r,e,t,u,o){if(u===t.length-1){o(r,e);return}var c,_=t[u];for(c=_-1;c>=0;c--)n("object"==typeof r?r[c]:r,"object"==typeof e?e[c]:e,t,u+1,o)},numeric._biforeach2=function n(r,e,t,u,o){if(u===t.length-1)return o(r,e);var c,_=t[u],a=Array(_);for(c=_-1;c>=0;--c)a[c]=n("object"==typeof r?r[c]:r,"object"==typeof e?e[c]:e,t,u+1,o);return a},numeric._foreach=function n(r,e,t,u){if(t===e.length-1){u(r);return}var o,c=e[t];for(o=c-1;o>=0;o--)n(r[o],e,t+1,u)},numeric._foreach2=function n(r,e,t,u){if(t===e.length-1)return u(r);var o,c=e[t],_=Array(c);for(o=c-1;o>=0;o--)_[o]=n(r[o],e,t+1,u);return _},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var n,r;for(n=0;n<numeric.mathfuns2.length;++n)r=numeric.mathfuns2[n],numeric.ops2[r]=r;for(n in numeric.ops2)if(numeric.ops2.hasOwnProperty(n)){r=numeric.ops2[n];var e,t,u="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,n)?(u="var "+r+" = Math."+r+";\n",e=function(n,e,t){return n+" = "+r+"("+e+","+t+")"},t=function(n,e){return n+" = "+r+"("+n+","+e+")"}):(e=function(n,e,t){return n+" = "+e+" "+r+" "+t},t=numeric.opseq.hasOwnProperty(n+"eq")?function(n,e){return n+" "+r+"= "+e}:function(n,e){return n+" = "+n+" "+r+" "+e}),numeric[n+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),u),numeric[n+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),u),numeric[n+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),u),numeric[n]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+n+"VV, VS = numeric."+n+"VS, SV = numeric."+n+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[r]=numeric[n],numeric[n+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),u),numeric[n+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),u),numeric[n+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+n+"eqV, S = numeric."+n+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(n=0;n<numeric.mathfuns2.length;++n)r=numeric.mathfuns2[n],delete numeric.ops2[r];for(n=0;n<numeric.mathfuns.length;++n)r=numeric.mathfuns[n],numeric.ops1[r]=r;for(n in numeric.ops1)numeric.ops1.hasOwnProperty(n)&&(u="",r=numeric.ops1[n],-1!==numeric.myIndexOf.call(numeric.mathfuns,n)&&Math.hasOwnProperty(r)&&(u="var "+r+" = Math."+r+";\n"),numeric[n+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+r+"(ret[i]);",u),numeric[n+"eq"]=Function("x",'if(typeof x !== "object") return '+r+"x\nvar i;\nvar V = numeric."+n+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[n+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+r+"(x[i]);",u),numeric[n]=Function("x",'if(typeof x !== "object") return '+r+"(x)\nvar i;\nvar V = numeric."+n+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(n=0;n<numeric.mathfuns.length;++n)r=numeric.mathfuns[n],delete numeric.ops1[r];for(n in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(n)&&(r=numeric.mapreducers[n],numeric[n+"V"]=numeric.mapreduce2(r[0],r[1]),numeric[n]=Function("x","s","k",r[1]+'if(typeof x !== "object") {    xi = x;\n'+r[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+n+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+r[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(n,r){return"object"==typeof n?"object"==typeof r?numeric.truncVV(n,r):numeric.truncVS(n,r):"object"==typeof r?numeric.truncSV(n,r):Math.round(n/r)*r},numeric.inv=function(n){var r,e,t,u,o,c,_,n,a=numeric.dim(n),f=Math.abs,$=a[0],s=a[1],m=numeric.clone(n),l=numeric.identity($);for(c=0;c<s;++c){var h=-1,p=-1;for(o=c;o!==$;++o)(_=f(m[o][c]))>p&&(h=o,p=_);for(e=m[h],m[h]=m[c],m[c]=e,u=l[h],l[h]=l[c],l[c]=u,n=e[c],_=c;_!==s;++_)e[_]/=n;for(_=s-1;-1!==_;--_)u[_]/=n;for(o=$-1;-1!==o;--o)if(o!==c){for(r=m[o],t=l[o],n=r[c],_=c+1;_!==s;++_)r[_]-=e[_]*n;for(_=s-1;_>0;--_)t[_]-=u[_]*n,--_,t[_]-=u[_]*n;0===_&&(t[0]-=u[0]*n)}}return l},numeric.det=function(n){var r=numeric.dim(n);if(2!==r.length||r[0]!==r[1])throw Error("numeric: det() only works on square matrices");var e,t,u,o,c,_,a,f,$=r[0],s=1,m=numeric.clone(n);for(t=0;t<$-1;t++){for(u=t,e=t+1;e<$;e++)Math.abs(m[e][t])>Math.abs(m[u][t])&&(u=e);for(u!==t&&(a=m[u],m[u]=m[t],m[t]=a,s*=-1),o=m[t],e=t+1;e<$;e++){for(_=(c=m[e])[t]/o[t],u=t+1;u<$-1;u+=2)f=u+1,c[u]-=o[u]*_,c[f]-=o[f]*_;u!==$&&(c[u]-=o[u]*_)}if(0===o[t])return 0;s*=o[t]}return s*m[t][t]},numeric.transpose=function(n){var r,e,t,u,o,c=n.length,_=n[0].length,a=Array(_);for(e=0;e<_;e++)a[e]=Array(c);for(r=c-1;r>=1;r-=2){for(u=n[r],t=n[r-1],e=_-1;e>=1;--e)(o=a[e])[r]=u[e],o[r-1]=t[e],(o=a[--e])[r]=u[e],o[r-1]=t[e];0===e&&((o=a[0])[r]=u[0],o[r-1]=t[0])}if(0===r){for(t=n[0],e=_-1;e>=1;--e)a[e][0]=t[e],a[--e][0]=t[e];0===e&&(a[0][0]=t[0])}return a},numeric.negtranspose=function(n){var r,e,t,u,o,c=n.length,_=n[0].length,a=Array(_);for(e=0;e<_;e++)a[e]=Array(c);for(r=c-1;r>=1;r-=2){for(u=n[r],t=n[r-1],e=_-1;e>=1;--e)(o=a[e])[r]=-u[e],o[r-1]=-t[e],(o=a[--e])[r]=-u[e],o[r-1]=-t[e];0===e&&((o=a[0])[r]=-u[0],o[r-1]=-t[0])}if(0===r){for(t=n[0],e=_-1;e>=1;--e)a[e][0]=-t[e],a[--e][0]=-t[e];0===e&&(a[0][0]=-t[0])}return a},numeric._random=function n(r,e){var t,u,o=r[e],c=Array(o);if(e===r.length-1){for(u=Math.random,t=o-1;t>=1;t-=2)c[t]=u(),c[t-1]=u();return 0===t&&(c[0]=u()),c}for(t=o-1;t>=0;t--)c[t]=n(r,e+1);return c},numeric.random=function(n){return numeric._random(n,0)},numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))},numeric.linspace=function(n,r,e){if(void 0===e&&(e=Math.max(Math.round(r-n)+1,1)),e<2)return 1===e?[n]:[];var t,u=Array(e);for(t=--e;t>=0;t--)u[t]=(t*r+(e-t)*n)/e;return u},numeric.getBlock=function(n,r,e){function t(n,o){var c,_=r[o],a=e[o]-_,f=Array(a);if(o===u.length-1){for(c=a;c>=0;c--)f[c]=n[c+_];return f}for(c=a;c>=0;c--)f[c]=t(n[c+_],o+1);return f}var u=numeric.dim(n);return t(n,0)},numeric.setBlock=function(n,r,e,t){function u(n,t,c){var _,a=r[c],f=e[c]-a;if(c===o.length-1)for(_=f;_>=0;_--)n[_+a]=t[_];for(_=f;_>=0;_--)u(n[_+a],t[_],c+1)}var o=numeric.dim(n);return u(n,t,0),n},numeric.getRange=function(n,r,e){var t,u,o,c,_=r.length,a=e.length,f=Array(_);for(t=_-1;-1!==t;--t)for(f[t]=Array(a),o=f[t],c=n[r[t]],u=a-1;-1!==u;--u)o[u]=c[e[u]];return f},numeric.blockMatrix=function(n){var r=numeric.dim(n);if(r.length<4)return numeric.blockMatrix([n]);var e,t,u,o,c,_=r[0],a=r[1];for(e=0,t=0,u=0;u<_;++u)e+=n[u][0].length;for(o=0;o<a;++o)t+=n[0][o][0].length;var f=Array(e);for(u=0;u<e;++u)f[u]=Array(t);var $,s,m,l,h,p=0;for(u=0;u<_;++u){for($=t,o=a-1;-1!==o;--o)for($-=(c=n[u][o])[0].length,m=c.length-1;-1!==m;--m)for(h=c[m],s=f[p+m],l=h.length-1;-1!==l;--l)s[$+l]=h[l];p+=n[u][0].length}return f},numeric.tensor=function(n,r){if("number"==typeof n||"number"==typeof r)return numeric.mul(n,r);var e=numeric.dim(n),t=numeric.dim(r);if(1!==e.length||1!==t.length)throw Error("numeric: tensor product is only defined for vectors");var u,o,c,_,a=e[0],f=t[0],$=Array(a);for(o=a-1;o>=0;o--){for(u=Array(f),_=n[o],c=f-1;c>=3;--c)u[c]=_*r[c],u[--c]=_*r[c],u[--c]=_*r[c],u[--c]=_*r[c];for(;c>=0;)u[c]=_*r[c],--c;$[o]=u}return $},numeric.T=function(n,r){this.x=n,this.y=r},numeric.t=function(n,r){return new numeric.T(n,r)},numeric.Tbinop=function(n,r,e,t,u){var o;if(numeric.indexOf,"string"!=typeof u)for(o in u="",numeric)numeric.hasOwnProperty(o)&&(n.indexOf(o)>=0||r.indexOf(o)>=0||e.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(u+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+u+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+r+");\n}\nreturn new numeric.T("+n+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var n=numeric.mul,r=numeric.div;if(this.y){var e=numeric.add(n(this.x,this.x),n(this.y,this.y));return new numeric.T(r(this.x,e),r(numeric.neg(this.y),e))}return new T(r(1,this.x))},numeric.T.prototype.div=function n(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var n=numeric.transpose,r=this.x,e=this.y;return e?new numeric.T(n(r),n(e)):new numeric.T(n(r))},numeric.T.prototype.transjugate=function(){var n=numeric.transpose,r=this.x,e=this.y;return e?new numeric.T(n(r),numeric.negtranspose(e)):new numeric.T(n(r))},numeric.Tunop=function(n,r,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+r+";\n}\n"+n+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var n=this;if(void 0===n.y)return new numeric.T(numeric.inv(n.x));var r,e,t,u,o,c,_,a,f,$,s,m,l,h,p,d,g,v,y=n.x.length,x=numeric.identity(y),b=numeric.rep([y,y],0),w=numeric.clone(n.x),S=numeric.clone(n.y);for(r=0;r<y;r++){for(m=(h=w[r][r])*h+(p=S[r][r])*p,t=r,e=r+1;e<y;e++)(l=(h=w[e][r])*h+(p=S[e][r])*p)>m&&(t=e,m=l);for(t!==r&&(v=w[r],w[r]=w[t],w[t]=v,v=S[r],S[r]=S[t],S[t]=v,v=x[r],x[r]=x[t],x[t]=v,v=b[r],b[r]=b[t],b[t]=v),u=w[r],o=S[r],a=x[r],f=b[r],h=u[r],p=o[r],e=r+1;e<y;e++)d=u[e],g=o[e],u[e]=(d*h+g*p)/m,o[e]=(g*h-d*p)/m;for(e=0;e<y;e++)d=a[e],g=f[e],a[e]=(d*h+g*p)/m,f[e]=(g*h-d*p)/m;for(e=r+1;e<y;e++){for(c=w[e],_=S[e],$=x[e],s=b[e],h=c[r],p=_[r],t=r+1;t<y;t++)d=u[t],g=o[t],c[t]-=d*h-g*p,_[t]-=g*h+d*p;for(t=0;t<y;t++)d=a[t],g=f[t],$[t]-=d*h-g*p,s[t]-=g*h+d*p}}for(r=y-1;r>0;r--)for(a=x[r],f=b[r],e=r-1;e>=0;e--)for($=x[e],s=b[e],h=w[e][r],p=S[e][r],t=y-1;t>=0;t--)d=a[t],g=f[t],$[t]-=h*d-p*g,s[t]-=h*g+p*d;return new numeric.T(x,b)},numeric.T.prototype.get=function(n){var r,e=this.x,t=this.y,u=0,o=n.length;if(t){for(;u<o;)e=e[r=n[u]],t=t[r],u++;return new numeric.T(e,t)}for(;u<o;)e=e[r=n[u]],u++;return new numeric.T(e)},numeric.T.prototype.set=function(n,r){var e,t=this.x,u=this.y,o=0,c=n.length,_=r.x,a=r.y;if(0===c)return a?this.y=a:u&&(this.y=void 0),this.x=t,this;if(a){for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u);o<c-1;)t=t[e=n[o]],u=u[e],o++;return t[e=n[o]]=_,u[e]=a,this}if(u){for(;o<c-1;)t=t[e=n[o]],u=u[e],o++;return t[e=n[o]]=_,_ instanceof Array?u[e]=numeric.rep(numeric.dim(_),0):u[e]=0,this}for(;o<c-1;)t=t[e=n[o]],o++;return t[e=n[o]]=_,this},numeric.T.prototype.getRows=function(n,r){var e,t,u=r-n+1,o=Array(u),c=this.x,_=this.y;for(e=n;e<=r;e++)o[e-n]=c[e];if(_){for(t=Array(u),e=n;e<=r;e++)t[e-n]=_[e];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(n,r,e){var t,u=this.x,o=this.y,c=e.x,_=e.y;for(t=n;t<=r;t++)u[t]=c[t-n];if(_)for(o||(o=numeric.rep(numeric.dim(u),0),this.y=o),t=n;t<=r;t++)o[t]=_[t-n];else if(o)for(t=n;t<=r;t++)o[t]=numeric.rep([c[t-n].length],0);return this},numeric.T.prototype.getRow=function(n){var r=this.x,e=this.y;return e?new numeric.T(r[n],e[n]):new numeric.T(r[n])},numeric.T.prototype.setRow=function(n,r){var e=this.x,t=this.y,u=r.x,o=r.y;return e[n]=u,o?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[n]=o):t&&(t=numeric.rep([u.length],0)),this},numeric.T.prototype.getBlock=function(n,r){var e=this.x,t=this.y,u=numeric.getBlock;return t?new numeric.T(u(e,n,r),u(t,n,r)):new numeric.T(u(e,n,r))},numeric.T.prototype.setBlock=function(n,r,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,u=this.y,o=numeric.setBlock,c=e.x,_=e.y;if(_)return u||(this.y=numeric.rep(numeric.dim(this),0),u=this.y),o(t,n,r,c),o(u,n,r,_),this;o(t,n,r,c),u&&o(u,n,r,numeric.rep(numeric.dim(c),0))},numeric.T.rep=function(n,r){var e=numeric.T;r instanceof e||(r=new e(r));var t=r.x,u=r.y,o=numeric.rep;return u?new e(o(n,t),o(n,u)):new e(o(n,t))},numeric.T.diag=function n(r){r instanceof numeric.T||(r=new numeric.T(r));var e=r.x,t=r.y,n=numeric.diag;return t?new numeric.T(n(e),n(t)):new numeric.T(n(e))},numeric.T.eig=function(){if(this.y)throw Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,r=this.x,e=this.y;return e?new n.T(n.getDiag(r),n.getDiag(e)):new n.T(n.getDiag(r))},numeric.house=function(n){var r=numeric.clone(n),e=(n[0]>=0?1:-1)*numeric.norm2(n);r[0]+=e;var t=numeric.norm2(r);if(0===t)throw Error("eig: internal error");return numeric.div(r,t)},numeric.toUpperHessenberg=function(n){var r=numeric.dim(n);if(2!==r.length||r[0]!==r[1])throw Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,u,o,c,_,a,f,$,s,m=r[0],l=numeric.clone(n),h=numeric.identity(m);for(t=0;t<m-2;t++){for(o=Array(m-t-1),e=t+1;e<m;e++)o[e-t-1]=l[e][t];if(numeric.norm2(o)>0){for(c=numeric.house(o),_=numeric.getBlock(l,[t+1,t],[m-1,m-1]),a=numeric.tensor(c,numeric.dot(c,_)),e=t+1;e<m;e++)for(f=l[e],$=a[e-t-1],u=t;u<m;u++)f[u]-=2*$[u-t];for(_=numeric.getBlock(l,[0,t+1],[m-1,m-1]),a=numeric.tensor(numeric.dot(_,c),c),e=0;e<m;e++)for(f=l[e],$=a[e],u=t+1;u<m;u++)f[u]-=2*$[u-t-1];for(_=Array(m-t-1),e=t+1;e<m;e++)_[e-t-1]=h[e];for(a=numeric.tensor(c,numeric.dot(c,_)),e=t+1;e<m;e++)for(s=h[e],$=a[e-t-1],u=0;u<m;u++)s[u]-=2*$[u]}}return{H:l,Q:h}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(n,r){void 0===r&&(r=1e4),n=numeric.clone(n),numeric.clone(n);var e,t,u,o,c,_,a,f,$,s,m,l,h,p,d,g,v,y,x=numeric.dim(n)[0],b=numeric.identity(x);if(x<3)return{Q:b,B:[[0,x-1]]};var w=numeric.epsilon;for(y=0;y<r;y++){for(g=0;g<x-1;g++)if(Math.abs(n[g+1][g])<w*(Math.abs(n[g][g])+Math.abs(n[g+1][g+1]))){var S,P,C,V=numeric.QRFrancis(numeric.getBlock(n,[0,0],[g,g]),r),q=numeric.QRFrancis(numeric.getBlock(n,[g+1,g+1],[x-1,x-1]),r);for(d=0,l=Array(g+1);d<=g;d++)l[d]=b[d];for(d=0,h=numeric.dot(V.Q,l);d<=g;d++)b[d]=h[d];for(l=Array(x-g-1),d=g+1;d<x;d++)l[d-g-1]=b[d];for(h=numeric.dot(q.Q,l),d=g+1;d<x;d++)b[d]=h[d-g-1];return{Q:b,B:V.B.concat(numeric.add(q.B,g+1))}}for(u=n[x-2][x-2],o=n[x-2][x-1],c=n[x-1][x-2],f=u+(_=n[x-1][x-1]),a=u*_-o*c,$=numeric.getBlock(n,[0,0],[2,2]),f*f>=4*a?(S=.5*(f+Math.sqrt(f*f-4*a)),P=.5*(f-Math.sqrt(f*f-4*a)),$=numeric.add(numeric.sub(numeric.dot($,$),numeric.mul($,S+P)),numeric.diag(numeric.rep([3],S*P)))):$=numeric.add(numeric.sub(numeric.dot($,$),numeric.mul($,f)),numeric.diag(numeric.rep([3],a))),e=[$[0][0],$[1][0],$[2][0]],t=numeric.house(e),l=[n[0],n[1],n[2]],h=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(m=n[d],p=h[d],v=0;v<x;v++)m[v]-=2*p[v];for(l=numeric.getBlock(n,[0,0],[x-1,2]),h=numeric.tensor(numeric.dot(l,t),t),d=0;d<x;d++)for(m=n[d],p=h[d],v=0;v<3;v++)m[v]-=2*p[v];for(l=[b[0],b[1],b[2]],h=numeric.tensor(t,numeric.dot(t,l)),d=0;d<3;d++)for(s=b[d],p=h[d],v=0;v<x;v++)s[v]-=2*p[v];for(g=0;g<x-2;g++){for(v=g;v<=g+1;v++)if(Math.abs(n[v+1][v])<w*(Math.abs(n[v][v])+Math.abs(n[v+1][v+1]))){var V=numeric.QRFrancis(numeric.getBlock(n,[0,0],[v,v]),r),q=numeric.QRFrancis(numeric.getBlock(n,[v+1,v+1],[x-1,x-1]),r);for(d=0,l=Array(v+1);d<=v;d++)l[d]=b[d];for(d=0,h=numeric.dot(V.Q,l);d<=v;d++)b[d]=h[d];for(l=Array(x-v-1),d=v+1;d<x;d++)l[d-v-1]=b[d];for(h=numeric.dot(q.Q,l),d=v+1;d<x;d++)b[d]=h[d-v-1];return{Q:b,B:V.B.concat(numeric.add(q.B,v+1))}}for(e=Array((C=Math.min(x-1,g+3))-g),d=g+1;d<=C;d++)e[d-g-1]=n[d][g];for(t=numeric.house(e),l=numeric.getBlock(n,[g+1,g],[C,x-1]),h=numeric.tensor(t,numeric.dot(t,l)),d=g+1;d<=C;d++)for(m=n[d],p=h[d-g-1],v=g;v<x;v++)m[v]-=2*p[v-g];for(l=numeric.getBlock(n,[0,g+1],[x-1,C]),h=numeric.tensor(numeric.dot(l,t),t),d=0;d<x;d++)for(m=n[d],p=h[d],v=g+1;v<=C;v++)m[v]-=2*p[v-g-1];for(l=Array(C-g),d=g+1;d<=C;d++)l[d-g-1]=b[d];for(h=numeric.tensor(t,numeric.dot(t,l)),d=g+1;d<=C;d++)for(s=b[d],p=h[d-g-1],v=0;v<x;v++)s[v]-=2*p[v]}}throw Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(n,r){var e,t,u,o,c,_,a,f,$,s,m,l,h,p,d,g,v,y=numeric.toUpperHessenberg(n),x=numeric.QRFrancis(y.H,r),b=numeric.T,w=n.length,S=x.B,P=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),C=new b(numeric.dot(x.Q,y.Q)),V=S.length,q=Math.sqrt;for(t=0;t<V;t++)if((e=S[t][0])!==S[t][1]){if(o=e+1,c=P[e][e],_=P[e][o],a=P[o][e],f=P[o][o],0===_&&0===a)continue;(m=($=-c-f)*$-4*(s=c*f-_*a))>=0?((g=(c-(l=$<0?-.5*($-q(m)):-.5*($+q(m))))*(c-l)+_*_)>(v=a*a+(f-l)*(f-l))?(p=(c-l)/(g=q(g)),d=_/g):(p=a/(v=q(v)),d=(f-l)/v),u=new b([[d,-p],[p,d]]),C.setRows(e,o,u.dot(C.getRows(e,o)))):(l=-.5*$,h=.5*q(-m),(g=(c-l)*(c-l)+_*_)>(v=a*a+(f-l)*(f-l))?(p=(c-l)/(g=q(g+h*h)),d=_/g,l=0,h/=g):(p=a/(v=q(v+h*h)),d=(f-l)/v,l=h/v,h=0),u=new b([[d,-p],[p,d]],[[l,h],[h,-l]]),C.setRows(e,o,u.dot(C.getRows(e,o))))}var D=C.dot(n).dot(C.transjugate()),w=n.length,M=numeric.T.identity(w);for(o=0;o<w;o++)if(o>0)for(t=o-1;t>=0;t--){var L=D.get([t,t]),I=D.get([o,o]);if(!numeric.neq(L.x,I.x)&&!numeric.neq(L.y,I.y)){M.setRow(o,M.getRow(t));continue}l=D.getRow(t).getBlock([t],[o-1]),h=M.getRow(o).getBlock([t],[o-1]),M.set([o,t],D.get([t,o]).neg().sub(l.dot(h)).div(L.sub(I)))}for(o=0;o<w;o++)l=M.getRow(o),M.setRow(o,l.div(l.norm2()));return M=M.transpose(),M=C.transjugate().dot(M),{lambda:D.getDiag(),E:M}},numeric.ccsSparse=function(n){var r,e,t,u,o=n.length,c=[];for(t=o-1;-1!==t;--t)for(u in e=n[t]){for(u=parseInt(u);u>=c.length;)c[c.length]=0;0!==e[u]&&c[u]++}var r=c.length,_=Array(r+1);for(t=0,_[0]=0;t<r;++t)_[t+1]=_[t]+c[t];var a=Array(_[r]),f=Array(_[r]);for(t=o-1;-1!==t;--t)for(u in e=n[t])0!==e[u]&&(c[u]--,a[_[u]+c[u]]=t,f[_[u]+c[u]]=e[u]);return[_,a,f]},numeric.ccsFull=function(n){var r,e,t,u,o=n[0],c=n[1],_=n[2],a=numeric.ccsDim(n),f=a[0],$=a[1],s=numeric.rep([f,$],0);for(r=0;r<$;r++)for(t=o[r],u=o[r+1],e=t;e<u;++e)s[c[e]][r]=_[e];return s},numeric.ccsTSolve=function(n,r,e,t,u){function o(n){var r;if(0===e[n]){for(e[n]=1,r=l[n];r<l[n+1];++r)o(h[r]);u[v]=n,++v}}var c,_,a,f,$,s,m,l=n[0],h=n[1],p=n[2],d=l.length-1,g=Math.max,v=0;for(void 0===t&&(e=numeric.rep([d],0)),void 0===t&&(t=numeric.linspace(0,e.length-1)),void 0===u&&(u=[]),c=t.length-1;-1!==c;--c)o(t[c]);for(u.length=v,c=u.length-1;-1!==c;--c)e[u[c]]=0;for(c=t.length-1;-1!==c;--c)e[_=t[c]]=r[_];for(c=u.length-1;-1!==c;--c){for(a=l[_=u[c]],f=g(l[_+1],a),$=a;$!==f;++$)if(h[$]===_){e[_]/=p[$];break}for(m=e[_],$=a;$!==f;++$)(s=h[$])!==_&&(e[s]-=m*p[$])}return e},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(n,r,e,t,u,o){var c,_,a,f=0,$=u.length,s=this.k,m=this.k1,l=this.j;if(0===t[n])for(t[n]=1,l[0]=n,s[0]=_=r[n],m[0]=a=r[n+1];;)if(_>=a){if(u[$]=l[f],0===f)return;++$,_=s[--f],a=m[f]}else 0===t[c=o[e[_]]]?(t[c]=1,s[f]=_,l[++f]=c,_=r[c],m[f]=a=r[c+1]):++_},numeric.ccsLPSolve=function(n,r,e,t,u,o,c){var _,a,f,$,s,m,l,h,p,d=n[0],g=n[1],v=n[2],y=(d.length-1,r[0]),x=r[1],b=r[2];for(a=y[u],f=y[u+1],t.length=0,_=a;_<f;++_)c.dfs(o[x[_]],d,g,e,t,o);for(_=t.length-1;-1!==_;--_)e[t[_]]=0;for(_=a;_!==f;++_)e[$=o[x[_]]]=b[_];for(_=t.length-1;-1!==_;--_){for(s=d[$=t[_]],m=d[$+1],l=s;l<m;++l)if(o[g[l]]===$){e[$]/=v[l];break}for(p=e[$],l=s;l<m;++l)(h=o[g[l]])!==$&&(e[h]-=p*v[l])}return e},numeric.ccsLUP1=function(n,r){var e,t,u,o,c,_,a,f=n[0].length-1,$=[numeric.rep([f+1],0),[],[]],s=[numeric.rep([f+1],0),[],[]],m=$[0],l=$[1],h=$[2],p=s[0],d=s[1],g=s[2],v=numeric.rep([f],0),y=numeric.rep([f],0),x=numeric.ccsLPSolve,b=Math.abs,w=numeric.linspace(0,f-1),S=numeric.linspace(0,f-1),P=new numeric.ccsDFS(f);for(void 0===r&&(r=1),e=0;e<f;++e){for(x($,n,v,y,e,S,P),o=-1,c=-1,t=y.length-1;-1!==t;--t)!((u=y[t])<=e)&&(_=b(v[u]))>o&&(c=u,o=_);for(b(v[e])<r*o&&(t=w[e],o=w[c],w[e]=o,S[o]=e,w[c]=t,S[t]=c,o=v[e],v[e]=v[c],v[c]=o),o=m[e],c=p[e],a=v[e],l[o]=w[e],h[o]=1,++o,t=y.length-1;-1!==t;--t)_=v[u=y[t]],y[t]=0,v[u]=0,u<=e?(d[c]=u,g[c]=_,++c):(l[o]=w[u],h[o]=_/a,++o);m[e+1]=o,p[e+1]=c}for(t=l.length-1;-1!==t;--t)l[t]=S[l[t]];return{L:$,U:s,P:w,Pinv:S}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(n,r,e,t,u,o,c){var _,a,f,$=0,s=u.length,m=this.k,l=this.k1,h=this.j;if(0===t[n])for(t[n]=1,h[0]=n,m[0]=a=r[o[n]],l[0]=f=r[o[n]+1];;){if(isNaN(a))throw Error("Ow!");if(a>=f){if(u[s]=o[h[$]],0===$)return;++s,a=m[--$],f=l[$]}else 0===t[_=e[a]]?(t[_]=1,m[$]=a,h[++$]=_,a=r[_=o[_]],l[$]=f=r[_+1]):++a}},numeric.ccsLPSolve0=function(n,r,e,t,u,o,c,_){var a,f,$,s,m,l,h,p,d,g=n[0],v=n[1],y=n[2],x=(g.length-1,r[0]),b=r[1],w=r[2];for(f=x[u],$=x[u+1],t.length=0,a=f;a<$;++a)_.dfs(b[a],g,v,e,t,o,c);for(a=t.length-1;-1!==a;--a)e[c[s=t[a]]]=0;for(a=f;a!==$;++a)e[s=b[a]]=w[a];for(a=t.length-1;-1!==a;--a){for(p=c[s=t[a]],m=g[s],l=g[s+1],h=m;h<l;++h)if(v[h]===p){e[p]/=y[h];break}for(d=e[p],h=m;h<l;++h)e[v[h]]-=d*y[h];e[p]=d}},numeric.ccsLUP0=function(n,r){var e,t,u,o,c,_,a,f=n[0].length-1,$=[numeric.rep([f+1],0),[],[]],s=[numeric.rep([f+1],0),[],[]],m=$[0],l=$[1],h=$[2],p=s[0],d=s[1],g=s[2],v=numeric.rep([f],0),y=numeric.rep([f],0),x=numeric.ccsLPSolve0,b=Math.abs,w=numeric.linspace(0,f-1),S=numeric.linspace(0,f-1),P=new numeric.ccsDFS0(f);for(void 0===r&&(r=1),e=0;e<f;++e){for(x($,n,v,y,e,S,w,P),o=-1,c=-1,t=y.length-1;-1!==t;--t)!((u=y[t])<=e)&&(_=b(v[w[u]]))>o&&(c=u,o=_);for(b(v[w[e]])<r*o&&(t=w[e],o=w[c],w[e]=o,S[o]=e,w[c]=t,S[t]=c),o=m[e],c=p[e],a=v[w[e]],l[o]=w[e],h[o]=1,++o,t=y.length-1;-1!==t;--t)_=v[w[u=y[t]]],y[t]=0,v[w[u]]=0,u<=e?(d[c]=u,g[c]=_,++c):(l[o]=w[u],h[o]=_/a,++o);m[e+1]=o,p[e+1]=c}for(t=l.length-1;-1!==t;--t)l[t]=S[l[t]];return{L:$,U:s,P:w,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(n){return[numeric.sup(n[1])+1,n[0].length-1]},numeric.ccsGetBlock=function(n,r,e){var t=numeric.ccsDim(n),u=t[0],o=t[1];void 0===r?r=numeric.linspace(0,u-1):"number"==typeof r&&(r=[r]),void 0===e?e=numeric.linspace(0,o-1):"number"==typeof e&&(e=[e]);var c,_,a,f,$,s=r.length,m=e.length,l=numeric.rep([o],0),h=[],p=[],d=[l,h,p],g=n[0],v=n[1],y=n[2],x=numeric.rep([u],0),b=0,w=numeric.rep([u],0);for(_=0;_<m;++_){var S=g[f=e[_]],P=g[f+1];for(c=S;c<P;++c)w[a=v[c]]=1,x[a]=y[c];for(c=0;c<s;++c)w[$=r[c]]&&(h[b]=c,p[b]=x[r[c]],++b);for(c=S;c<P;++c)w[a=v[c]]=0;l[_+1]=b}return d},numeric.ccsDot=function(n,r){var e,t,u,o,c,_,a,f,$,s,m,l=n[0],h=n[1],p=n[2],d=r[0],g=r[1],v=r[2],y=numeric.ccsDim(n),x=numeric.ccsDim(r),b=y[0],w=(y[1],x[1]),S=numeric.rep([b],0),P=numeric.rep([b],0),C=Array(b),V=numeric.rep([w],0),q=[],D=[],M=[V,q,D];for(u=0;u!==w;++u){for(o=d[u],c=d[u+1],$=0,t=o;t<c;++t)for(s=g[t],m=v[t],_=l[s],a=l[s+1],e=_;e<a;++e)0===P[f=h[e]]&&(C[$]=f,P[f]=1,$+=1),S[f]=S[f]+p[e]*m;for(c=(o=V[u])+$,V[u+1]=c,t=$-1;-1!==t;--t)m=o+t,e=C[t],q[m]=e,D[m]=S[e],P[e]=0,S[e]=0;V[u+1]=V[u]+$}return M},numeric.ccsLUPSolve=function(n,r){var e=n.L,t=n.U,u=(n.P,r[0]),o=!1;"object"!=typeof u&&(u=(r=[[0,r.length],numeric.linspace(0,r.length-1),r])[0],o=!0);var c,_,a,f,$,s,m=r[1],l=r[2],h=e[0].length-1,p=u.length-1,d=numeric.rep([h],0),g=Array(h),v=numeric.rep([h],0),y=Array(h),x=numeric.rep([p+1],0),b=[],w=[],S=numeric.ccsTSolve,P=0;for(c=0;c<p;++c){for($=0,a=u[c],f=u[c+1],_=a;_<f;++_)s=n.Pinv[m[_]],y[$]=s,v[s]=l[_],++$;for(y.length=$,S(e,v,d,y,g),_=y.length-1;-1!==_;--_)v[y[_]]=0;if(S(t,d,v,g,y),o)return v;for(_=g.length-1;-1!==_;--_)d[g[_]]=0;for(_=y.length-1;-1!==_;--_)s=y[_],b[P]=s,w[P]=v[s],v[s]=0,++P;x[c+1]=P}return[x,b,w]},numeric.ccsbinop=function(n,r){return void 0===r&&(r=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+r+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+n+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(n){var r,e=n[0],t=n[1],u=n[2],o=numeric.sup(t)+1,c=e.length,_=numeric.rep([o],0),a=Array(c),f=Array(c),$=numeric.rep([o],0);for(r=0;r<c;++r)$[t[r]]++;for(r=0;r<o;++r)_[r+1]=_[r]+$[r];var s,m,l=_.slice(0);for(r=0;r<c;++r)a[s=l[m=t[r]]]=e[r],f[s]=u[r],l[m]=l[m]+1;return[_,a,f]},numeric.ccsGather=function(n){var r,e,t,u,o,c=n[0],_=n[1],a=n[2],f=c.length-1,$=_.length,s=Array($),m=Array($),l=Array($);for(r=0,o=0;r<f;++r)for(t=c[r],u=c[r+1],e=t;e!==u;++e)m[o]=r,s[o]=_[e],l[o]=a[e],++o;return[s,m,l]},numeric.sdim=function n(r,e,t){var u;if(void 0===e&&(e=[]),"object"!=typeof r)return e;for(u in void 0===t&&(t=0),t in e||(e[t]=0),r.length>e[t]&&(e[t]=r.length),r)r.hasOwnProperty(u)&&n(r[u],e,t+1);return e},numeric.sclone=function n(r,e,t){void 0===e&&(e=0),void 0===t&&(t=numeric.sdim(r).length);var u,o=Array(r.length);if(e===t-1){for(u in r)r.hasOwnProperty(u)&&(o[u]=r[u]);return o}for(u in r)r.hasOwnProperty(u)&&(o[u]=n(r[u],e+1,t));return o},numeric.sdiag=function(n){var r,e,t=n.length,u=Array(t);for(r=t-1;r>=1;r-=2)e=r-1,u[r]=[],u[r][r]=n[r],u[e]=[],u[e][e]=n[e];return 0===r&&(u[0]=[],u[0][0]=n[r]),u},numeric.sidentity=function(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function(n){var r,e,t,u=[];for(r in n.length,n)if(n.hasOwnProperty(r))for(e in t=n[r])t.hasOwnProperty(e)&&("object"!=typeof u[e]&&(u[e]=[]),u[e][r]=t[e]);return u},numeric.sLUP=function(n,r){throw Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(n,r){var e,t,u,o,c,_,a,f=n.length,$=(r.length,numeric.stranspose(r)),s=$.length,m=Array(f);for(u=f-1;u>=0;u--){for(a=[],e=n[u],c=s-1;c>=0;c--){for(o in _=0,t=$[c],e)e.hasOwnProperty(o)&&o in t&&(_+=e[o]*t[o]);_&&(a[c]=_)}m[u]=a}return m},numeric.sdotMV=function(n,r){var e,t,u,o,c=n.length,_=Array(c);for(t=c-1;t>=0;t--){for(u in e=n[t],o=0,e)e.hasOwnProperty(u)&&r[u]&&(o+=e[u]*r[u]);o&&(_[t]=o)}return _},numeric.sdotVM=function(n,r){var e,t,u,o,c=[];for(e in n)if(n.hasOwnProperty(e))for(t in u=r[e],o=n[e],u)u.hasOwnProperty(t)&&(c[t]||(c[t]=0),c[t]+=o*u[t]);return c},numeric.sdotVV=function(n,r){var e,t=0;for(e in n)n[e]&&r[e]&&(t+=n[e]*r[e]);return t},numeric.sdot=function(n,r){var e=numeric.sdim(n).length,t=numeric.sdim(r).length,u=1e3*e+t;switch(u){case 0:return n*r;case 1001:return numeric.sdotVV(n,r);case 2001:return numeric.sdotMV(n,r);case 1002:return numeric.sdotVM(n,r);case 2002:return numeric.sdotMM(n,r);default:throw Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(n){var r,e,t,u,o=n[0].length,c=n.length,_=[];for(e=o-1;e>=0;--e)if(n[c-1][e]){for(t=0,u=_;t<c-2;t++)u[r=n[t][e]]||(u[r]=[]),u=u[r];u[n[t][e]]=n[t+1][e]}return _},numeric.sgather=function n(r,e,t){var u,o,c;for(o in void 0===e&&(e=[]),void 0===t&&(t=[]),u=t.length,r)if(r.hasOwnProperty(o)){if(t[u]=parseInt(o),"number"==typeof(c=r[o])){if(c){if(0===e.length)for(o=u+1;o>=0;--o)e[o]=[];for(o=u;o>=0;--o)e[o].push(t[o]);e[u+1].push(c)}}else n(c,e,t)}return t.length>u&&t.pop(),e},numeric.cLU=function(n){var r,e,t,u,o,c,_=n[0],a=n[1],f=n[2],$=_.length,s=0;for(r=0;r<$;r++)_[r]>s&&(s=_[r]);var m,l,h,p=Array(++s),d=Array(s),g=numeric.rep([s],1/0),v=numeric.rep([s],-1/0);for(t=0;t<$;t++)r=_[t],(e=a[t])<g[r]&&(g[r]=e),e>v[r]&&(v[r]=e);for(r=0;r<s-1;r++)v[r]>v[r+1]&&(v[r+1]=v[r]);for(r=s-1;r>=1;r--)g[r]<g[r-1]&&(g[r-1]=g[r]);var y=0,x=0;for(r=0;r<s;r++)d[r]=numeric.rep([v[r]-g[r]+1],0),p[r]=numeric.rep([r-g[r]],0),y+=r-g[r]+1,x+=v[r]-r+1;for(t=0;t<$;t++)d[r=_[t]][a[t]-g[r]]=f[t];for(r=0;r<s-1;r++)for(u=r-g[r],m=d[r],e=r+1;g[e]<=r&&e<s;e++)if(o=r-g[e],c=v[r]-r,h=(l=d[e])[o]/m[u]){for(t=1;t<=c;t++)l[t+o]-=h*m[t+u];p[e][r-g[e]]=h}var $,b,w,m=[],l=[],S=[],P=[],C=[],V=[];for($=0,b=0,r=0;r<s;r++){for(u=g[r],o=v[r],w=d[r],e=r;e<=o;e++)w[e-u]&&(m[$]=r,l[$]=e,S[$]=w[e-u],$++);for(w=p[r],e=u;e<r;e++)w[e-u]&&(P[b]=r,C[b]=e,V[b]=w[e-u],b++);P[b]=r,C[b]=r,V[b]=1,b++}return{U:[m,l,S],L:[P,C,V]}},numeric.cLUsolve=function(n,r){var e,t,u=n.L,o=n.U,c=numeric.clone(r),_=u[0],a=u[1],f=u[2],$=o[0],s=o[1],m=o[2],l=$.length,h=(_.length,c.length);for(e=0,t=0;e<h;e++){for(;a[t]<e;)c[e]-=f[t]*c[a[t]],t++;t++}for(t=l-1,e=h-1;e>=0;e--){for(;s[t]>e;)c[e]-=m[t]*c[s[t]],t--;c[e]/=m[t],t--}return c},numeric.cgrid=function(n,r){"number"==typeof n&&(n=[n,n]);var e,t,u,o=numeric.rep(n,-1);for("function"!=typeof r&&(r="L"===r?function(r,e){return r>=n[0]/2||e<n[1]/2}:function(n,r){return!0}),e=1,u=0;e<n[0]-1;e++)for(t=1;t<n[1]-1;t++)r(e,t)&&(o[e][t]=u,u++);return o},numeric.cdelsq=function(n){var r,e,t,u,o,c=[[-1,0],[0,-1],[0,1],[1,0]],_=numeric.dim(n),a=_[0],f=_[1],$=[],s=[],m=[];for(r=1;r<a-1;r++)for(e=1;e<f-1;e++)if(!(n[r][e]<0)){for(t=0;t<4;t++)u=r+c[t][0],o=e+c[t][1],n[u][o]<0||($.push(n[r][e]),s.push(n[u][o]),m.push(-1));$.push(n[r][e]),s.push(n[r][e]),m.push(4)}return[$,s,m]},numeric.cdotMV=function(n,r){var e,t,u,o=n[0],c=n[1],_=n[2],a=o.length;for(t=0,u=0;t<a;t++)o[t]>u&&(u=o[t]);for(u++,e=numeric.rep([u],0),t=0;t<a;t++)e[o[t]]+=_[t]*r[c[t]];return e},numeric.Spline=function(n,r,e,t,u){this.x=n,this.yl=r,this.yr=e,this.kl=t,this.kr=u},numeric.Spline.prototype._at=function(n,r){var n,e,t,u,o=this.x,c=this.yl,_=this.yr,a=this.kl,f=this.kr,$=numeric.add,s=numeric.sub,m=numeric.mul;e=s(m(a[r],o[r+1]-o[r]),s(_[r+1],c[r])),t=$(m(f[r+1],o[r]-o[r+1]),s(_[r+1],c[r]));var l=(u=(n-o[r])/(o[r+1]-o[r]))*(1-u);return $($($(m(1-u,c[r]),m(u,_[r+1])),m(e,l*(1-u))),m(t,l*u))},numeric.Spline.prototype.at=function(n){if("number"==typeof n){var r,e,t,u=this.x,o=u.length,c=Math.floor;for(r=0,e=o-1;e-r>1;)u[t=c((r+e)/2)]<=n?r=t:e=t;return this._at(n,r)}var _,o=n.length,a=Array(o);for(_=o-1;-1!==_;--_)a[_]=this.at(n[_]);return a},numeric.Spline.prototype.diff=function(){var n,r,e,t=this.x,u=this.yl,o=this.yr,c=this.kl,_=this.kr,a=u.length,f=c,$=_,s=Array(a),m=Array(a),l=numeric.add,h=numeric.mul,p=numeric.div,d=numeric.sub;for(n=a-1;-1!==n;--n)r=t[n+1]-t[n],e=d(o[n+1],u[n]),s[n]=p(l(h(e,6),h(c[n],-4*r),h(_[n+1],-2*r)),r*r),m[n+1]=p(l(h(e,-6),h(c[n],2*r),h(_[n+1],4*r)),r*r);return new numeric.Spline(t,f,$,s,m)},numeric.Spline.prototype.roots=function(){function n(n){return n*n}function r(n,r,e,t,u){var o=2*e-(r-n),c=-(2*t)+(r-n),_=(u+1)*.5,a=_*(1-_);return(1-_)*n+_*r+o*a*(1-_)+c*a*_}var e=[],t=this.x,u=this.yl,o=this.yr,c=this.kl,_=this.kr;"number"==typeof u[0]&&(u=[u],o=[o],c=[c],_=[_]);var a,f,$,s,m,l,h,p,d,g,v,y,x,b,w,S,P,C,V,q,D,M,L,I,O=u.length,B=t.length-1,e=Array(O),U=Math.sqrt;for(a=0;a!==O;++a){for(s=u[a],m=o[a],l=c[a],h=_[a],p=[],f=0;f!==B;f++){for(f>0&&m[f]*s[f]<0&&p.push(t[f]),S=t[f+1]-t[f],P=t[f],v=s[f],y=m[f+1],w=n((d=l[f]/S)-(g=h[f+1]/S)+3*(v-y))+12*g*v,x=g+3*v+2*d-3*y,b=3*(g+d+2*(v-y)),w<=0?C=(V=x/b)>t[f]&&V<t[f+1]?[t[f],V,t[f+1]]:[t[f],t[f+1]]:(V=(x-U(w))/b,q=(x+U(w))/b,C=[t[f]],V>t[f]&&V<t[f+1]&&C.push(V),q>t[f]&&q<t[f+1]&&C.push(q),C.push(t[f+1])),M=C[0],V=this._at(M,f),$=0;$<C.length-1;$++){if(L=C[$+1],q=this._at(L,f),0===V){p.push(M),M=L,V=q;continue}if(0===q||V*q>0){M=L,V=q;continue}for(var N=0;!((I=(V*L-q*M)/(V-q))<=M)&&!(I>=L);)if((D=this._at(I,f))*q>0)L=I,q=D,-1===N&&(V*=.5),N=-1;else{if(!(D*V>0))break;M=I,V=D,1===N&&(q*=.5),N=1}p.push(I),M=C[$+1],V=this._at(M,f)}0===q&&p.push(L)}e[a]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(n,r,e,t){var u,o=n.length,c=[],_=[],a=[],f=numeric.sub,$=numeric.mul,s=numeric.add;for(u=o-2;u>=0;u--)_[u]=n[u+1]-n[u],a[u]=f(r[u+1],r[u]);("string"==typeof e||"string"==typeof t)&&(e=t="periodic");var m=[[],[],[]];switch(typeof e){case"undefined":c[0]=$(3/(_[0]*_[0]),a[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/_[0],1/_[0]);break;case"string":c[0]=s($(3/(_[o-2]*_[o-2]),a[o-2]),$(3/(_[0]*_[0]),a[0])),m[0].push(0,0,0),m[1].push(o-2,0,1),m[2].push(1/_[o-2],2/_[o-2]+2/_[0],1/_[0]);break;default:c[0]=e,m[0].push(0),m[1].push(0),m[2].push(1)}for(u=1;u<o-1;u++)c[u]=s($(3/(_[u-1]*_[u-1]),a[u-1]),$(3/(_[u]*_[u]),a[u])),m[0].push(u,u,u),m[1].push(u-1,u,u+1),m[2].push(1/_[u-1],2/_[u-1]+2/_[u],1/_[u]);switch(typeof t){case"undefined":c[o-1]=$(3/(_[o-2]*_[o-2]),a[o-2]),m[0].push(o-1,o-1),m[1].push(o-2,o-1),m[2].push(1/_[o-2],2/_[o-2]);break;case"string":m[1][m[1].length-1]=0;break;default:c[o-1]=t,m[0].push(o-1),m[1].push(o-1),m[2].push(1)}var l=Array((c="number"!=typeof c[0]?numeric.transpose(c):[c]).length);if("string"==typeof e)for(u=l.length-1;-1!==u;--u)l[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),c[u]),l[u][o-1]=l[u][0];else for(u=l.length-1;-1!==u;--u)l[u]=numeric.cLUsolve(numeric.cLU(m),c[u]);return l="number"==typeof r[0]?l[0]:numeric.transpose(l),new numeric.Spline(n,r,r,l,l)},numeric.fftpow2=function n(r,e){var t=r.length;if(1!==t){var u,o,c=Math.cos,_=Math.sin,a=Array(t/2),f=Array(t/2),$=Array(t/2),s=Array(t/2);for(o=t/2,u=t-1;-1!==u;--u)$[--o]=r[u],s[o]=e[u],--u,a[o]=r[u],f[o]=e[u];n(a,f),n($,s),o=t/2;var m,l,h,p=-6.283185307179586/t;for(u=t-1;-1!==u;--u)-1==--o&&(o=t/2-1),l=c(m=p*u),h=_(m),r[u]=a[o]+l*$[o]-h*s[o],e[u]=f[o]+l*s[o]+h*$[o]}},numeric._ifftpow2=function n(r,e){var t=r.length;if(1!==t){var u,o,c=Math.cos,_=Math.sin,a=Array(t/2),f=Array(t/2),$=Array(t/2),s=Array(t/2);for(o=t/2,u=t-1;-1!==u;--u)$[--o]=r[u],s[o]=e[u],--u,a[o]=r[u],f[o]=e[u];n(a,f),n($,s),o=t/2;var m,l,h,p=6.283185307179586/t;for(u=t-1;-1!==u;--u)-1==--o&&(o=t/2-1),l=c(m=p*u),h=_(m),r[u]=a[o]+l*$[o]-h*s[o],e[u]=f[o]+l*s[o]+h*$[o]}},numeric.ifftpow2=function(n,r){numeric._ifftpow2(n,r),numeric.diveq(n,n.length),numeric.diveq(r,r.length)},numeric.convpow2=function(n,r,e,t){numeric.fftpow2(n,r),numeric.fftpow2(e,t);var u,o,c,_,a,f=n.length;for(u=f-1;-1!==u;--u)o=n[u],_=r[u],c=e[u],a=t[u],n[u]=o*c-_*a,r[u]=o*a+_*c;numeric.ifftpow2(n,r)},numeric.T.prototype.fft=function(){var n,r,e=this.x,t=this.y,u=e.length,o=Math.log,c=o(2),_=Math.pow(2,Math.ceil(o(2*u-1)/c)),a=numeric.rep([_],0),f=numeric.rep([_],0),$=Math.cos,s=Math.sin,m=-3.141592653589793/u,l=numeric.rep([_],0),h=numeric.rep([_],0);for(n=0;n<u;n++)l[n]=e[n];if(void 0!==t)for(n=0;n<u;n++)h[n]=t[n];for(n=1,a[0]=1;n<=_/2;n++)r=m*n*n,a[n]=$(r),f[n]=s(r),a[_-n]=$(r),f[_-n]=s(r);var p=new numeric.T(l,h),d=new numeric.T(a,f);return p=p.mul(d),numeric.convpow2(p.x,p.y,numeric.clone(d.x),numeric.neg(d.y)),(p=p.mul(d)).x.length=u,p.y.length=u,p},numeric.T.prototype.ifft=function(){var n,r,e=this.x,t=this.y,u=e.length,o=Math.log,c=o(2),_=Math.pow(2,Math.ceil(o(2*u-1)/c)),a=numeric.rep([_],0),f=numeric.rep([_],0),$=Math.cos,s=Math.sin,m=3.141592653589793/u,l=numeric.rep([_],0),h=numeric.rep([_],0);for(n=0;n<u;n++)l[n]=e[n];if(void 0!==t)for(n=0;n<u;n++)h[n]=t[n];for(n=1,a[0]=1;n<=_/2;n++)r=m*n*n,a[n]=$(r),f[n]=s(r),a[_-n]=$(r),f[_-n]=s(r);var p=new numeric.T(l,h),d=new numeric.T(a,f);return p=p.mul(d),numeric.convpow2(p.x,p.y,numeric.clone(d.x),numeric.neg(d.y)),(p=p.mul(d)).x.length=u,p.y.length=u,p.div(u)},numeric.gradient=function(n,r){var e=r.length,t=n(r);if(isNaN(t))throw Error("gradient: f(x) is a NaN!");var u,o,c,_,a,f,$,s,m,l,h=Math.max,p=numeric.clone(r),d=Array(e),h=(numeric.div,numeric.sub,Math.max),g=.001,v=Math.abs,y=Math.min,x=0;for(u=0;u<e;u++)for(var b=h(1e-6*t,1e-8);;){if(++x>20)throw Error("Numerical gradient fails");if(p[u]=r[u]+b,o=n(p),p[u]=r[u]-b,c=n(p),p[u]=r[u],isNaN(o)||isNaN(c)){b/=16;continue}if(d[u]=(o-c)/(2*b),a=r[u]-b,f=r[u],$=r[u]+b,s=(o-t)/b,m=(t-c)/b,l=h(v(d[u]),v(t),v(o),v(c),v(a),v(f),v($),1e-8),!((_=y(h(v(s-d[u]),v(m-d[u]),v(s-m))/l,b/l))>g))break;b/=16}return d},numeric.uncmin=function(n,r,e,t,u,o,c){var _=numeric.gradient;void 0===c&&(c={}),void 0===e&&(e=1e-8),void 0===t&&(t=function(r){return _(n,r)}),void 0===u&&(u=1e3);var a,f,$=(r=numeric.clone(r)).length,s=n(r);if(isNaN(s))throw Error("uncmin: f(x0) is a NaN!");var m=Math.max,l=numeric.norm2;e=m(e,numeric.epsilon);var h,p,d,g,v,y,x,b,w,S,P=c.Hinv||numeric.identity($),C=numeric.dot,V=(numeric.inv,numeric.sub),q=numeric.add,D=numeric.tensor,M=numeric.div,L=numeric.mul,I=numeric.all,O=numeric.isFinite,B=numeric.neg,U=0,N="";for(p=t(r);U<u;){if("function"==typeof o&&o(U,r,s,p,P)){N="Callback returned true";break}if(!I(O(p))){N="Gradient has Infinity or NaN";break}if(!I(O(h=B(C(P,p))))){N="Search direction has Infinity or NaN";break}if((S=l(h))<e){N="Newton step smaller than tol";break}for(w=1,f=C(p,h),v=r;U<u&&!(w*S<e);){if(v=q(r,g=L(h,w)),(a=n(v))-s>=.1*w*f||isNaN(a)){w*=.5,++U;continue}break}if(w*S<e){N="Line search step size smaller than tol";break}if(U===u){N="maxit reached during line search";break}b=C(y=V(d=t(v),p),g),x=C(P,y),P=V(q(P,L((b+C(y,x))/(b*b),D(g,g))),M(q(D(x,g),D(g,x)),b)),r=v,s=a,p=d,++U}return{solution:r,f:s,gradient:p,invHessian:P,iterations:U,message:N}},numeric.Dopri=function(n,r,e,t,u,o,c){this.x=n,this.y=r,this.f=e,this.ymid=t,this.iterations=u,this.events=c,this.message=o},numeric.Dopri.prototype._at=function(n,r){function e(n){return n*n}var t,u,o,c,_,a,n,f,$,s,m,l=this,h=l.x,p=l.y,d=l.f,g=l.ymid,v=(h.length,.5),y=numeric.add,x=numeric.mul,b=numeric.sub;return t=h[r],u=h[r+1],c=p[r],_=p[r+1],f=u-t,o=t+v*f,a=g[r],$=b(d[r],x(c,1/(t-o)+2/(t-u))),s=b(d[r+1],x(_,1/(u-o)+2/(u-t))),y(y(y(y(x(c,(m=[e(n-u)*(n-o)/e(t-u)/(t-o),e(n-t)*e(n-u)/e(t-o)/e(u-o),e(n-t)*(n-o)/e(u-t)/(u-o),(n-t)*e(n-u)*(n-o)/e(t-u)/(t-o),(n-u)*e(n-t)*(n-o)/e(t-u)/(u-o)])[0]),x(a,m[1])),x(_,m[2])),x($,m[3])),x(s,m[4]))},numeric.Dopri.prototype.at=function(n){var r,e,t,u=Math.floor;if("number"!=typeof n){var o=n.length,c=Array(o);for(r=o-1;-1!==r;--r)c[r]=this.at(n[r]);return c}var _=this.x;for(r=0,e=_.length-1;e-r>1;)_[t=u(.5*(r+e))]<=n?r=t:e=t;return this._at(n,r)},numeric.dopri=function(n,r,e,t,u,o,c){void 0===u&&(u=1e-6),void 0===o&&(o=1e3);var _,a,f,$,s,m,l,h,p,d,g,v,y,x=[n],b=[e],w=[t(n,e)],S=[],P=.2,C=[.075,.225],V=[44/45,-56/15,32/9],q=[19372/6561,-25360/2187,64448/6561,-212/729],D=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],M=[35/384,0,500/1113,125/192,-2187/6784,11/84],L=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],I=[.2,.3,.8,8/9,1,1],O=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],B=0,U=(r-n)/10,N=0,R=numeric.add,X=numeric.mul,E=Math.min,F=Math.abs,Y=numeric.norminf,z=Math.pow,A=numeric.any,W=numeric.lt,Q=numeric.and,Z=(numeric.sub,new numeric.Dopri(x,b,w,S,-1,""));for("function"==typeof c&&(g=c(n,e));n<r&&N<o;){if(++N,n+U>r&&(U=r-n),_=t(n+I[0]*U,R(e,X(P*U,w[B]))),a=t(n+I[1]*U,R(R(e,X(C[0]*U,w[B])),X(C[1]*U,_))),f=t(n+I[2]*U,R(R(R(e,X(V[0]*U,w[B])),X(V[1]*U,_)),X(V[2]*U,a))),$=t(n+I[3]*U,R(R(R(R(e,X(q[0]*U,w[B])),X(q[1]*U,_)),X(q[2]*U,a)),X(q[3]*U,f))),s=t(n+I[4]*U,R(R(R(R(R(e,X(D[0]*U,w[B])),X(D[1]*U,_)),X(D[2]*U,a)),X(D[3]*U,f)),X(D[4]*U,$))),p=R(R(R(R(R(e,X(w[B],U*M[0])),X(a,U*M[2])),X(f,U*M[3])),X($,U*M[4])),X(s,U*M[5])),m=t(n+U,p),(d="number"==typeof(l=R(R(R(R(R(X(w[B],U*O[0]),X(a,U*O[2])),X(f,U*O[3])),X($,U*O[4])),X(s,U*O[5])),X(m,U*O[6])))?F(l):Y(l))>u){if(n+(U=.2*U*z(u/d,.25))===n){Z.msg="Step size became too small";break}continue}if(S[B]=R(R(R(R(R(R(e,X(w[B],U*L[0])),X(a,U*L[2])),X(f,U*L[3])),X($,U*L[4])),X(s,U*L[5])),X(m,U*L[6])),x[++B]=n+U,b[B]=p,w[B]=m,"function"==typeof c){var H,G,J=n,K=n+.5*U;if(v=c(K,S[B-1]),A(y=Q(W(g,0),W(0,v)))||(J=K,K=n+U,g=v,v=c(K,p),y=Q(W(g,0),W(0,v))),A(y)){for(var nn,nr,ne=0,ni=1,nt=1;;){if("number"==typeof g)G=(nt*v*J-ni*g*K)/(nt*v-ni*g);else for(G=K,h=g.length-1;-1!==h;--h)g[h]<0&&v[h]>0&&(G=E(G,(nt*v[h]*J-ni*g[h]*K)/(nt*v[h]-ni*g[h])));if(G<=J||G>=K)break;H=Z._at(G,B-1),nr=c(G,H),A(nn=Q(W(g,0),W(0,nr)))?(K=G,v=nr,y=nn,nt=1,-1===ne?ni*=.5:ni=1,ne=-1):(J=G,g=nr,ni=1,1===ne?nt*=.5:nt=1,ne=1)}return p=Z._at(.5*(n+G),B-1),Z.f[B]=t(G,H),Z.x[B]=G,Z.y[B]=H,Z.ymid[B-1]=p,Z.events=y,Z.iterations=N,Z}}n+=U,e=p,g=v,U=E(.8*U*z(u/d,.25),4*U)}return Z.iterations=N,Z},numeric.LU=function(n,r){r=r||!1;var e,t,u,o,c,_,a,f,$,s=Math.abs,m=n.length,l=m-1,h=Array(m);for(r||(n=numeric.clone(n)),u=0;u<m;++u){for(a=u,$=s((_=n[u])[u]),t=u+1;t<m;++t)$<(o=s(n[t][u]))&&($=o,a=t);for(h[u]=a,a!=u&&(n[u]=n[a],n[a]=_,_=n[u]),c=_[u],e=u+1;e<m;++e)n[e][u]/=c;for(e=u+1;e<m;++e){for(f=n[e],t=u+1;t<l;++t)f[t]-=f[u]*_[t],++t,f[t]-=f[u]*_[t];t===l&&(f[t]-=f[u]*_[t])}}return{LU:n,P:h}},numeric.LUsolve=function(n,r){var e,t,u,o,c,_=n.LU,a=_.length,f=numeric.clone(r),$=n.P;for(e=a-1;-1!==e;--e)f[e]=r[e];for(e=0;e<a;++e)for(u=$[e],$[e]!==e&&(c=f[e],f[e]=f[u],f[u]=c),o=_[e],t=0;t<e;++t)f[e]-=f[t]*o[t];for(e=a-1;e>=0;--e){for(o=_[e],t=e+1;t<a;++t)f[e]-=f[t]*o[t];f[e]/=o[e]}return f},numeric.solve=function(n,r,e){return numeric.LUsolve(numeric.LU(n,e),r)},numeric.echelonize=function(n){var r,e,t,u,o,c,_,a,f=numeric.dim(n),$=f[0],s=f[1],m=numeric.identity($),l=Array($),h=Math.abs,p=numeric.diveq;for(r=0,n=numeric.clone(n);r<$;++r){for(t=0,o=n[r],c=m[r],e=1;e<s;++e)h(o[t])<h(o[e])&&(t=e);for(l[r]=t,p(c,o[t]),p(o,o[t]),e=0;e<$;++e)if(e!==r){for(a=(_=n[e])[t],u=s-1;-1!==u;--u)_[u]-=o[u]*a;for(_=m[e],u=$-1;-1!==u;--u)_[u]-=c[u]*a}}return{I:m,A:n,P:l}},numeric.__solveLP=function(n,r,e,t,u,o,c){var _,a,f,$,s=numeric.sum,m=(numeric.log,numeric.mul),l=numeric.sub,h=numeric.dot,p=numeric.div,d=numeric.add,g=n.length,v=e.length,y=!1,x=0,b=1,w=(numeric.transpose(r),numeric.svd,numeric.transpose),S=(numeric.leq,Math.sqrt),P=Math.abs,C=(numeric.muleq,numeric.norminf,numeric.any,Math.min),V=numeric.all,q=numeric.gt,D=Array(g),M=Array(v),L=(numeric.rep([v],1),numeric.solve),I=l(e,h(r,o)),O=h(n,n);for(f=x;f<u;++f){for(B=v-1;-1!==B;--B)M[B]=p(r[B],I[B]);var B,U,N=w(M);for(B=g-1;-1!==B;--B)D[B]=s(N[B]);b=.25*P(O/h(n,D));var R=100*S(O/h(D,D));for((!isFinite(b)||b>R)&&(b=R),$=d(n,m(b,D)),a=h(N,M),B=g-1;-1!==B;--B)a[B][B]+=1;U=L(a,p($,b),!0);var X=p(I,h(r,U)),E=1;for(B=v-1;-1!==B;--B)X[B]<0&&(E=C(E,-.999*X[B]));if(_=l(o,m(U,E)),I=l(e,h(r,_)),!V(q(I,0)))return{solution:o,message:"",iterations:f};if(o=_,b<t)return{solution:_,message:"",iterations:f};if(c){var F=h(n,$),Y=h(r,$);for(y=!0,B=v-1;-1!==B;--B)if(F*Y[B]<0){y=!1;break}}else y=!(o[g-1]>=0);if(y)return{solution:_,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(n,r,e,t,u){var o,c=n.length,_=e.length,a=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,$=(numeric.div,numeric.add,numeric.rep([c],0).concat([1])),s=numeric.rep([_,1],-1),m=numeric.blockMatrix([[r,s]]),l=e,o=numeric.rep([c],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),h=numeric.__solveLP($,m,l,t,u,o,!1),p=numeric.clone(h.solution);if(p.length=c,0>numeric.inf(a(e,f(r,p))))return{solution:NaN,message:"Infeasible",iterations:h.iterations};var d=numeric.__solveLP(n,r,e,t,u-h.iterations,p,!0);return d.iterations+=h.iterations,d},numeric.solveLP=function(n,r,e,t,u,o,c){if(void 0===c&&(c=1e3),void 0===o&&(o=numeric.epsilon),void 0===t)return numeric._solveLP(n,r,e,o,c);var _,a=t.length,f=t[0].length,$=r.length,s=numeric.echelonize(t),m=numeric.rep([f],0),l=s.P,h=[];for(_=l.length-1;-1!==_;--_)m[l[_]]=1;for(_=f-1;-1!==_;--_)0===m[_]&&h.push(_);var p=numeric.getRange,d=numeric.linspace(0,a-1),g=numeric.linspace(0,$-1),v=p(t,d,h),y=p(r,g,l),x=p(r,g,h),b=numeric.dot,w=numeric.sub,S=b(y,s.I),P=w(x,b(S,v)),C=w(e,b(S,u)),V=Array(l.length),q=Array(h.length);for(_=l.length-1;-1!==_;--_)V[_]=n[l[_]];for(_=h.length-1;-1!==_;--_)q[_]=n[h[_]];var D=w(q,b(V,b(s.I,v))),M=numeric._solveLP(D,P,C,o,c),L=M.solution;if(L!=L)return M;var I=b(s.I,w(u,b(v,L))),O=Array(n.length);for(_=l.length-1;-1!==_;--_)O[l[_]]=I[_];for(_=h.length-1;-1!==_;--_)O[h[_]]=L[_];return{solution:O,message:M.message,iterations:M.iterations}},numeric.MPStoLP=function(n){function r(r){throw Error("MPStoLP: "+r+"\nLine "+e+": "+n[e]+"\nCurrent state: "+_[c]+"\n")}n instanceof String&&n.split("\n");var e,t,u,o,c=0,_=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=n.length,f=0,$={},s=[],m=0,l={},h=0,p=[],d=[],g=[];for(e=0;e<a;++e){var v=(u=n[e]).match(/\S*/g),y=[];for(t=0;t<v.length;++t)""!==v[t]&&y.push(v[t]);if(0!==y.length){for(t=0;t<_.length&&u.substr(0,_[t].length)!==_[t];++t);if(t<_.length){if(c=t,1===t&&(o=y[1]),6===t)return{name:o,c:p,A:numeric.transpose(d),b:g,rows:$,vars:l};continue}switch(c){case 0:case 1:r("Unexpected line");case 2:switch(y[0]){case"N":0===f?f=y[1]:r("Two or more N rows");break;case"L":$[y[1]]=m,s[m]=1,g[m]=0,++m;break;case"G":$[y[1]]=m,s[m]=-1,g[m]=0,++m;break;case"E":$[y[1]]=m,s[m]=0,g[m]=0,++m;break;default:r("Parse error "+numeric.prettyPrint(y))}break;case 3:l.hasOwnProperty(y[0])||(l[y[0]]=h,p[h]=0,d[h]=numeric.rep([m],0),++h);var x=l[y[0]];for(t=1;t<y.length;t+=2){if(y[t]===f){p[x]=parseFloat(y[t+1]);continue}var b=$[y[t]];d[x][b]=(s[b]<0?-1:1)*parseFloat(y[t+1])}break;case 4:for(t=1;t<y.length;t+=2)g[$[y[t]]]=(s[$[y[t]]]<0?-1:1)*parseFloat(y[t+1]);break;case 5:break;case 6:r("Internal error")}}}r("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(n,r,e,t,u,o,c){function _(n){var r,t,u=this,o=n.length,c=0,_=u.i=u.j=u.m=0;for(u.S=[],u.c=[],o||(n=[o++]);c<e;)u.S[c]=c++;for(c=0;c<e;c++)_=$(_+(r=u.S[c])+n[c%o]),t=u.S[_],u.S[c]=t,u.S[_]=r;u.g=function(n){var r=u.S,t=$(u.i+1),o=r[t],c=$(u.j+o),_=r[c];r[t]=_,r[c]=o;for(var a=r[$(o+_)];--n;)o=r[t=$(t+1)],_=r[c=$(c+o)],r[t]=_,r[c]=o,a=a*e+r[$(o+_)];return u.i=t,u.j=c,a},u.g(e)}function a(n,r,e,t,u){if(e=[],u=typeof n,r&&"object"==u){for(t in n)if(5>t.indexOf("S"))try{e.push(a(n[t],r-1))}catch(o){}}return e.length?e:n+("string"!=u?"\0":"")}function f(n,r,e,t){for(n+="",e=0,t=0;t<n.length;t++)r[$(t)]=$((e^=19*r[$(t)])+n.charCodeAt(t));for(t in n="",r)n+=String.fromCharCode(r[t]);return n}function $(n){return n&e-1}r.seedrandom=function($,s){var m,l=[];return $=f(a(s?[$,n]:arguments.length?$:[(new Date).getTime(),n,window],3),l),f((m=new _(l)).S,n),r.random=function(){for(var n=m.g(t),r=c,_=0;n<u;)n=(n+_)*e,r*=e,_=m.g(1);for(;n>=o;)n/=2,r/=2,_>>>=1;return(n+_)/r},$},c=r.pow(e,t),o=2*(u=r.pow(2,u)),f(r.random(),n)}([],numeric.seedrandom,256,6,52),function(n){function r(n){if("object"!=typeof n)return n;var e,t=[],u=n.length;for(e=0;e<u;e++)t[e+1]=r(n[e]);return t}function e(n){if("object"!=typeof n)return n;var r,t=[],u=n.length;for(r=1;r<u;r++)t[r-1]=e(n[r]);return t}function t(n,r,e){var t,u,o,c,_;for(o=1;o<=e;o+=1){for(n[o][o]=1/n[o][o],_=-n[o][o],t=1;t<o;t+=1)n[t][o]=_*n[t][o];if(e<(c=o+1))break;for(u=c;u<=e;u+=1)for(_=n[o][u],n[o][u]=0,t=1;t<=o;t+=1)n[t][u]=n[t][u]+_*n[t][o]}}function u(n,r,e,t){var u,o,c,_;for(o=1;o<=e;o+=1){for(u=1,_=0;u<o;u+=1)_+=n[u][o]*t[u];t[o]=(t[o]-_)/n[o][o]}for(c=1;c<=e;c+=1)for(t[o=e+1-c]=t[o]/n[o][o],_=-t[o],u=1;u<o;u+=1)t[u]=t[u]+_*n[u][o]}function o(n,r,e,t){var u,o,c,_,a,f;for(o=1;o<=e;o+=1){if(t[1]=o,f=0,(c=o-1)<1){if((f=n[o][o]-f)<=0)break;n[o][o]=Math.sqrt(f)}else{for(_=1;_<=c;_+=1){for(u=1,a=n[_][o];u<_;u+=1)a-=n[u][o]*n[u][_];a/=n[_][_],n[_][o]=a,f+=a*a}if((f=n[o][o]-f)<=0)break;n[o][o]=Math.sqrt(f)}t[1]=0}}function c(n,r,e,c,_,a,f,$,s,m,l,h,p,d,g,v){var y,x,b,w,S,P,C,V,q,D,M,L,I,O,B,U,N,R,X,E,F,Y,z,A,W,Q,Z;function H(){for(d[1]=d[1]+1,b=D,y=1;y<=m;y+=1){for(b+=1,U=-$[y],x=1;x<=c;x+=1)U+=f[x][y]*_[x];if(Math.abs(U)<A&&(U=0),y>l)g[b]=U;else if(g[b]=-Math.abs(U),U>0){for(x=1;x<=c;x+=1)f[x][y]=-f[x][y];$[y]=-$[y]}}for(y=1;y<=p;y+=1)g[D+h[y]]=0;for(L=0,B=0,y=1;y<=m;y+=1)g[D+y]<B*g[O+y]&&(L=y,B=g[D+y]/g[O+y]);return 0===L?999:0}function G(){for(y=1;y<=c;y+=1){for(x=1,U=0;x<=c;x+=1)U+=n[x][y]*f[x][L];g[y]=U}for(y=1,w=C;y<=c;y+=1)g[w+y]=0;for(x=p+1;x<=c;x+=1)for(y=1;y<=c;y+=1)g[w+y]=g[w+y]+n[y][x]*g[x];for(Y=!0,y=p;y>=1;y-=1){for(U=g[y],w=(b=q+y*(y+3)/2)-y,x=y+1;x<=p;x+=1)U-=g[b]*g[V+x],b+=x;if(U/=g[w],g[V+y]=U,h[y]<l||U<0)break;Y=!1,P=y}if(!Y)for(y=1,N=g[M+P]/g[V+P];y<=p&&!(h[y]<l)&&!(g[V+y]<0);y+=1)(B=g[M+y]/g[V+y])<N&&(N=B,P=y);for(U=0,y=C+1;y<=C+c;y+=1)U+=g[y]*g[y];if(Math.abs(U)<=A){if(Y)return v[1]=1,999;for(y=1;y<=p;y+=1)g[M+y]=g[M+y]-N*g[V+y];return g[M+p+1]=g[M+p+1]+N,700}for(y=1,U=0;y<=c;y+=1)U+=g[C+y]*f[y][L];for(R=-g[D+L]/U,z=!0,Y||N<R&&(R=N,z=!1),y=1;y<=c;y+=1)_[y]=_[y]+R*g[C+y],Math.abs(_[y])<A&&(_[y]=0);for(y=1,a[1]=a[1]+R*U*(R/2+g[M+p+1]);y<=p;y+=1)g[M+y]=g[M+y]-R*g[V+y];if(g[M+p+1]=g[M+p+1]+R,!z){for(x=1,U=-$[L];x<=c;x+=1)U+=_[x]*f[x][L];if(L>l)g[D+L]=U;else if(g[D+L]=-Math.abs(U),U>0){for(x=1;x<=c;x+=1)f[x][L]=-f[x][L];$[L]=-$[L]}return 700}for(h[p+=1]=L,b=q+(p-1)*p/2+1,y=1;y<=p-1;y+=1)g[b]=g[y],b+=1;if(p===c)g[b]=g[c];else{for(y=c;y>=p+1&&0!==g[y]&&(X=Math.max(Math.abs(g[y-1]),Math.abs(g[y])),E=Math.min(Math.abs(g[y-1]),Math.abs(g[y])),B=g[y-1]>=0?Math.abs(X*Math.sqrt(1+E*E/(X*X))):-Math.abs(X*Math.sqrt(1+E*E/(X*X))),X=g[y-1]/B,E=g[y]/B,1!==X);y-=1)if(0===X)for(x=1,g[y-1]=E*B;x<=c;x+=1)B=n[x][y-1],n[x][y-1]=n[x][y],n[x][y]=B;else for(g[y-1]=B,F=E/(1+X),x=1;x<=c;x+=1)B=X*n[x][y-1]+E*n[x][y],n[x][y]=F*(n[x][y-1]+B)-n[x][y],n[x][y-1]=B;g[b]=g[p]}return 0}function J(){if(0===g[w=(b=q+P*(P+1)/2+1)+P]||(X=Math.max(Math.abs(g[w-1]),Math.abs(g[w])),E=Math.min(Math.abs(g[w-1]),Math.abs(g[w])),B=g[w-1]>=0?Math.abs(X*Math.sqrt(1+E*E/(X*X))):-Math.abs(X*Math.sqrt(1+E*E/(X*X))),X=g[w-1]/B,E=g[w]/B,1===X))return 798;if(0===X){for(y=P+1;y<=p;y+=1)B=g[w-1],g[w-1]=g[w],g[w]=B,w+=y;for(y=1;y<=c;y+=1)B=n[y][P],n[y][P]=n[y][P+1],n[y][P+1]=B}else{for(F=E/(1+X),y=P+1;y<=p;y+=1)B=X*g[w-1]+E*g[w],g[w]=F*(g[w-1]+B)-g[w],g[w-1]=B,w+=y;for(y=1;y<=c;y+=1)B=X*n[y][P]+E*n[y][P+1],n[y][P+1]=F*(n[y][P]+B)-n[y][P+1],n[y][P]=B}return 0}function K(){for(y=1,w=b-P;y<=P;y+=1)g[w]=g[b],b+=1,w+=1;return g[M+P]=g[M+P+1],h[P]=h[P+1],(P+=1)<p?797:0}function nn(){return g[M+p]=g[M+p+1],g[M+p+1]=0,h[p]=0,p-=1,d[2]=d[2]+1,0}I=Math.min(c,m),b=2*c+I*(I+5)/2+2*m+1,A=1e-60;do A+=A,W=1+.1*A,Q=1+.2*A;while(W<=1||Q<=1);for(y=1;y<=c;y+=1)g[y]=r[y];for(y=c+1;y<=b;y+=1)g[y]=0;for(y=1;y<=m;y+=1)h[y]=0;if(S=[],0===v[1]){if(o(n,e,c,S),0!==S[1]){v[1]=2;return}u(n,e,c,r),t(n,e,c)}else{for(x=1;x<=c;x+=1)for(y=1,_[x]=0;y<=x;y+=1)_[x]=_[x]+n[y][x]*r[y];for(x=1;x<=c;x+=1)for(r[x]=0,y=x;y<=c;y+=1)r[x]=r[x]+n[x][y]*_[y]}for(x=1,a[1]=0;x<=c;x+=1)for(_[x]=r[x],a[1]=a[1]+g[x]*_[x],g[x]=0,y=x+1;y<=c;y+=1)n[y][x]=0;for(a[1]=-a[1]/2,v[1]=0,O=(D=(q=(M=(V=(C=c)+c)+I)+I+1)+I*(I+1)/2)+m,y=1;y<=m;y+=1){for(x=1,U=0;x<=c;x+=1)U+=f[x][y]*f[x][y];g[O+y]=Math.sqrt(U)}for(p=0,d[1]=0,d[2]=0,Z=0;;){if(999===(Z=H()))return;for(;0!==(Z=G());){if(999===Z)return;if(700===Z){if(P===p)nn();else{for(;J(),797===(Z=K()););nn()}}}}}function _(n,t,u,o,_,a){n=r(n),t=r(t),u=r(u);var f,$,s,m,l,h,p=[],d=[],g=[],v=[],y=[];if(_=_||0,a=a?r(a):[void 0,0],o=o?r(o):[],$=n.length-1,s=u[1].length-1,!o)for(f=1;f<=s;f+=1)o[f]=0;for(f=1;f<=s;f+=1)d[f]=0;for(m=0,l=Math.min($,s),f=1;f<=$;f+=1)g[f]=0;for(f=1,p[1]=0;f<=2*$+l*(l+5)/2+2*s+1;f+=1)v[f]=0;for(f=1;f<=2;f+=1)y[f]=0;return c(n,t,$,$,g,p,u,o,$,s,_,d,m,y,v,a),h="",1===a[1]&&(h="constraints are inconsistent, no solution!"),2===a[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:e(g),value:e(p),unconstrained_solution:e(t),iterations:e(y),iact:e(d),message:h}}n.solveQP=_}(numeric),numeric.svd=function(n){function r(n,r){return(n=Math.abs(n))>(r=Math.abs(r))?n*Math.sqrt(1+r*r/n/n):0==r?n:r*Math.sqrt(1+n*n/r/r)}var e,t=numeric.epsilon,u=1e-64/t,o=50,c=0,_=0,a=0,f=0,$=0,s=numeric.clone(n),m=s.length,l=s[0].length;if(m<l)throw"Need more rows than columns";var h=Array(l),p=Array(l);for(_=0;_<l;_++)h[_]=p[_]=0;var d=numeric.rep([l,l],0),g=0,v=0,y=0,x=0,b=0,w=0,S=0;for(_=0;_<l;_++){for(h[_]=v,S=0,$=_+1,a=_;a<m;a++)S+=s[a][_]*s[a][_];if(S<=u)v=0;else for(g=s[_][_],v=Math.sqrt(S),g>=0&&(v=-v),y=g*v-S,s[_][_]=g-v,a=$;a<l;a++){for(S=0,f=_;f<m;f++)S+=s[f][_]*s[f][a];for(g=S/y,f=_;f<m;f++)s[f][a]+=g*s[f][_]}for(p[_]=v,S=0,a=$;a<l;a++)S+=s[_][a]*s[_][a];if(S<=u)v=0;else{for(g=s[_][_+1],v=Math.sqrt(S),g>=0&&(v=-v),y=g*v-S,s[_][_+1]=g-v,a=$;a<l;a++)h[a]=s[_][a]/y;for(a=$;a<m;a++){for(S=0,f=$;f<l;f++)S+=s[a][f]*s[_][f];for(f=$;f<l;f++)s[a][f]+=S*h[f]}}(b=Math.abs(p[_])+Math.abs(h[_]))>x&&(x=b)}for(_=l-1;-1!=_;_+=-1){if(0!=v){for(y=v*s[_][_+1],a=$;a<l;a++)d[a][_]=s[_][a]/y;for(a=$;a<l;a++){for(S=0,f=$;f<l;f++)S+=s[_][f]*d[f][a];for(f=$;f<l;f++)d[f][a]+=S*d[f][_]}}for(a=$;a<l;a++)d[_][a]=0,d[a][_]=0;d[_][_]=1,v=h[_],$=_}for(_=l-1;-1!=_;_+=-1){for($=_+1,v=p[_],a=$;a<l;a++)s[_][a]=0;if(0!=v){for(y=s[_][_]*v,a=$;a<l;a++){for(S=0,f=$;f<m;f++)S+=s[f][_]*s[f][a];for(g=S/y,f=_;f<m;f++)s[f][a]+=g*s[f][_]}for(a=_;a<m;a++)s[a][_]=s[a][_]/v}else for(a=_;a<m;a++)s[a][_]=0;s[_][_]+=1}for(t*=x,f=l-1;-1!=f;f+=-1)for(var P=0;P<o;P++){var C=!1;for($=f;-1!=$;$+=-1){if(Math.abs(h[$])<=t){C=!0;break}if(Math.abs(p[$-1])<=t)break}if(!C){c=0,S=1;var V=$-1;for(_=$;_<f+1&&(g=S*h[_],h[_]=c*h[_],!(Math.abs(g)<=t));_++)for(y=r(g,v=p[_]),p[_]=y,c=v/y,S=-g/y,a=0;a<m;a++)b=s[a][V],w=s[a][_],s[a][V]=b*c+w*S,s[a][_]=-b*S+w*c}if(w=p[f],$==f){if(w<0)for(a=0,p[f]=-w;a<l;a++)d[a][f]=-d[a][f];break}if(P>=o-1)throw"Error: no convergence.";for(x=p[$],b=p[f-1],v=r(g=((b-w)*(b+w)+((v=h[f-1])-(y=h[f]))*(v+y))/(2*y*b),1),g=g<0?((x-w)*(x+w)+y*(b/(g-v)-y))/x:((x-w)*(x+w)+y*(b/(g+v)-y))/x,c=1,S=1,_=$+1;_<f+1;_++){for(v=h[_],b=p[_],y=S*v,v*=c,w=r(g,y),h[_-1]=w,g=x*(c=g/w)+v*(S=y/w),v=-x*S+v*c,y=b*S,b*=c,a=0;a<l;a++)x=d[a][_-1],w=d[a][_],d[a][_-1]=x*c+w*S,d[a][_]=-x*S+w*c;for(w=r(g,y),p[_-1]=w,g=(c=g/w)*v+(S=y/w)*b,x=-S*v+c*b,a=0;a<m;a++)b=s[a][_-1],w=s[a][_],s[a][_-1]=b*c+w*S,s[a][_]=-b*S+w*c}h[$]=0,h[f]=g,p[f]=x}for(_=0;_<p.length;_++)p[_]<t&&(p[_]=0);for(_=0;_<l;_++)for(a=_-1;a>=0;a--)if(p[a]<p[_]){for(c=p[a],p[a]=p[_],p[_]=c,f=0;f<s.length;f++)e=s[f][_],s[f][_]=s[f][a],s[f][a]=e;for(f=0;f<d.length;f++)e=d[f][_],d[f][_]=d[f][a],d[f][a]=e;_=a}return{U:s,S:p,V:d}},stats=function(n){for(var r,e={mean:0,variance:0,deviation:0},t=n.length,u=0,o=t;o--;u+=n[o]);for(r=e.mean=u/t,o=t,u=0;o--;u+=Math.pow(n[o]-r,2));return e.deviation=Math.sqrt(e.variance=u/t),e};var generate141Matrix=function(n){result=[];for(var r=0;r<n;r++){for(var e=[],t=0;t<n;t++)t==r?e.push(4):1==Math.abs(r-t)?e.push(1):e.push(0);result.push(e)}return result},generateConstantMatrix=function(n){for((result=[]).push(numeric.sub(numeric.mul(n[1],6),n[0])),i=2;i<n.length-2;i++)result.push(numeric.mul(n[i],6));return result.push(numeric.sub(numeric.mul(n[n.length-2],6),n[n.length-1])),result},convertBSplineControlPointsToBezierControlPoints=function(n){for(var r=[],e=0;e<n.length-1;e++){var t,u=[0==e?n[0]:t,numeric.add(numeric.mul(2/3,n[e]),numeric.mul(1/3,n[e+1])),numeric.add(numeric.mul(1/3,n[e]),numeric.mul(2/3,n[e+1])),t=e==n.length-2?n[n.length-1]:numeric.add(numeric.mul(1/6,n[e]),numeric.mul(2/3,n[e+1]),numeric.mul(1/6,n[e+2]))];r.push(u)}return r},getBezierControlPoints=function(n){if(n.length<4){if(3===n.length)return[t=[n[0],n[1],n[1],n[2]]];if(2===n.length)return[t=[n[0],n[0],n[1],n[1]]];if(1===n.length)return[t=[n[0],n[0],n[0],n[0]]]}var r=generate141Matrix(n.length-2),e=generateConstantMatrix(n),e=numeric.dot(numeric.inv(r),e);e.splice(0,0,n[0]),e.push(n[n.length-1]);var t=convertBSplineControlPointsToBezierControlPoints(e);return t};!function(n){function r(r,e){var t=this,u=n.extend({},n.fn.signaturePad.defaults,e),o=n(r),c=n(u.canvas,o),_=c.get(0),a=null,f={x:null,y:null},$=[],s=!1,m=!1,l=!1,h=!1,p=30,d=p,g=0,v=[];function y(){clearTimeout(s),m=s=!1}function x(r,e){var o,c;if(r.preventDefault(),c=n(r.target).offset(),clearTimeout(s),s=!1,c=void 0!==r.changedTouches?(o=Math.floor(r.changedTouches[0].pageX-c.left),Math.floor(r.changedTouches[0].pageY-c.top)):(o=Math.floor(r.pageX-c.left),Math.floor(r.pageY-c.top)),f.x===o&&f.y===c)return!0;if(null===f.x&&(f.x=o),null===f.y&&(f.y=c),e&&(c+=e),a.beginPath(),a.moveTo(f.x,f.y),a.lineTo(o,c),a.lineCap=u.penCap,a.stroke(),a.closePath(),!0===u.drawBezierCurves&&(v.push({lx:o,ly:c,mx:f.x,my:f.y}),e=4*u.bezierSkip,v.length>=e)){var _=$.slice($.length-e+2,$.length);for(i in a.strokeStyle=u.bgColour,_){var m=_[i];a.beginPath(),a.moveTo(m.mx,m.my),a.lineTo(m.lx,m.ly),a.lineCap=u.penCap,a.stroke(),a.closePath()}a.strokeStyle=u.penColour,I(v,a),v=v.slice(e-1,e)}$.push({lx:o,ly:c,mx:f.x,my:f.y}),f.x=o,f.y=c,u.onDraw&&"function"==typeof u.onDraw&&u.onDraw.apply(t)}function b(r){r&&"touchend"!==r.type&&"touchcancel"!=r.type?x(r,1):(l?c.each(function(){this.removeEventListener("touchmove",x)}):c.unbind("mousemove.signaturepad"),0<$.length&&(u.onDrawEnd&&"function"==typeof u.onDrawEnd&&u.onDrawEnd.apply(t),v=[],w(),O($,a,!1))),f.x=null,f.y=null,u.output&&0<$.length&&n(u.output,o).val(JSON.stringify($))}function w(){a.clearRect(0,0,_.width,_.height),a.fillStyle=u.bgColour,a.fillRect(0,0,_.width,_.height),u.displayOnly||u.lineWidth&&(a.beginPath(),a.lineWidth=u.lineWidth,a.strokeStyle=u.lineColour,a.moveTo(u.lineMargin,u.lineTop),a.lineTo(_.width-u.lineMargin,u.lineTop),a.stroke(),a.closePath()),a.lineWidth=u.penWidth,a.strokeStyle=u.penColour}function S(){w(),n(u.output,o).val(""),$=[],b()}function P(n,r){null==f.x?x(n,1):x(n,r)}function C(n,r){l?r.addEventListener("touchmove",P,!1):c.bind("mousemove.signaturepad",P),x(n,1)}function V(r){h||(h=!0,n("input").blur(),void 0!==r.changedTouches&&(l=!0),l?(c.each(function(){this.addEventListener("touchend",b,!1),this.addEventListener("touchcancel",b,!1)}),c.unbind("mousedown.signaturepad")):(n(document).bind("mouseup.signaturepad",function(){m&&(b(),y())}),c.bind("mouseleave.signaturepad",function(n){m&&b(n),m&&!s&&(s=setTimeout(function(){b(),y()},500))}),c.each(function(){this.ontouchstart=null})))}function q(){n(u.typed,o).hide(),S(),c.each(function(){this.ontouchstart=function(n){n.preventDefault(),m=!0,V(n),C(n,this)}}),c.bind("mousedown.signaturepad",function(n){n.preventDefault(),m=!0,V(n),C(n)}),n(u.clear,o).bind("click.signaturepad",function(n){n.preventDefault(),S()}),n(u.typeIt,o).bind("click.signaturepad",function(n){n.preventDefault(),D()}),n(u.drawIt,o).unbind("click.signaturepad"),n(u.drawIt,o).bind("click.signaturepad",function(n){n.preventDefault()}),n(u.typeIt,o).removeClass(u.currentClass),n(u.drawIt,o).addClass(u.currentClass),n(u.sig,o).addClass(u.currentClass),n(u.typeItDesc,o).hide(),n(u.drawItDesc,o).show(),n(u.clear,o).show()}function D(){S(),h=!1,c.each(function(){this.removeEventListener&&(this.removeEventListener("touchend",b),this.removeEventListener("touchcancel",b),this.removeEventListener("touchmove",x)),this.ontouchstart&&(this.ontouchstart=null)}),n(document).unbind("mouseup.signaturepad"),c.unbind("mousedown.signaturepad"),c.unbind("mousemove.signaturepad"),c.unbind("mouseleave.signaturepad"),n(u.clear,o).unbind("click.signaturepad"),n(u.typed,o).show(),n(u.drawIt,o).bind("click.signaturepad",function(n){n.preventDefault(),q()}),n(u.typeIt,o).unbind("click.signaturepad"),n(u.typeIt,o).bind("click.signaturepad",function(n){n.preventDefault()}),n(u.output,o).val(""),n(u.drawIt,o).removeClass(u.currentClass),n(u.typeIt,o).addClass(u.currentClass),n(u.sig,o).removeClass(u.currentClass),n(u.drawItDesc,o).hide(),n(u.clear,o).hide(),n(u.typeItDesc,o).show(),d=p=n(u.typed,o).css("font-size").replace(/px/,"")}function M(r){var e=n(u.typed,o),t=r.replace(/>/g,"&gt;").replace(/</g,"&lt;").trim(),r=g,c=.5*d;if(g=t.length,e.html(t),t){if(r<g&&e.outerWidth()>_.width)for(;e.outerWidth()>_.width;)d--,e.css("font-size",d+"px");if(g<r&&e.outerWidth()+c<_.width&&d<p)for(;e.outerWidth()+c<_.width&&d<p;)d++,e.css("font-size",d+"px")}else e.css("font-size",p+"px")}function L(){var r=!0,e={drawInvalid:!1,nameInvalid:!1},c=[o,u],_=[e,o,u];return(u.onBeforeValidate&&"function"==typeof u.onBeforeValidate?u.onBeforeValidate:function(r,e){n("p."+e.errorClass,r).remove(),r.removeClass(e.errorClass),n("input, label",r).removeClass(e.errorClass)}).apply(t,c),u.drawOnly&&$.length<1&&(r=(e.drawInvalid=!0,!1)),""===n(u.name,o).val()&&(r=(e.nameInvalid=!0,!1)),(u.onFormError&&"function"==typeof u.onFormError?u.onFormError:function(r,e,t){r.nameInvalid&&(e.prepend(['<p class="',t.errorClass,'">',t.errorMessage,"</p>"].join("")),n(t.name,e).focus(),n(t.name,e).addClass(t.errorClass),n("label[for="+n(t.name).attr("id")+"]",e).addClass(t.errorClass)),r.drawInvalid&&e.prepend(['<p class="',t.errorClass,'">',t.errorMessageDraw,"</p>"].join(""))}).apply(t,_),r}function I(n,r){for(var e,t,o=[],c=[],_=0;_<n.length-1;_++)"object"==typeof n[_]&&"object"==typeof n[_+1]&&(e=n[_],t=n[_+1],e.mx==e.lx&&e.my==e.ly||(o.push(e),e.lx==t.mx&&e.ly==t.my||e.mx==t.lx&&e.my==t.ly||(c.push(o),o=[]),_==n.length-2&&(o.push(t),c.push(o))));var a=[];for(k=0;k<c.length;k++){var f=c[k].pop();for(c[k]=c[k].filter(function(n,r){return r%u.bezierSkip==0}),c[k].push(f),o=c[k],j=0;j<o.length;j++){var $=o[j],$=Math.abs($.lx-$.mx)+Math.abs($.ly-$.my);a.push($)}}var s=stats(a);for(s.length=numeric.sum(a),s.mean*=3,s.deviation*=3,k=0;k<c.length;k++){var m=(o=c[k]).map(function(n){return[n.lx,n.ly]}),l=getBezierControlPoints(m);for(_ in l){var h,p,d=l[_][0],g=l[_][1],v=l[_][2],y=l[_][3];!0===u.variableStrokeWidth&&(0<(h=(Math.abs(d[0]-g[0])+Math.abs(g[0]-v[0])+Math.abs(v[0]-y[0])+Math.abs(d[1]-g[1])+Math.abs(g[1]-v[1])+Math.abs(v[1]-y[1])-s.mean)/s.deviation)?p=3-h/2.5:h<=0&&(p=3-2*h)),r.beginPath(),r.moveTo(d[0],d[1]),r.bezierCurveTo(g[0],g[1],v[0],v[1],y[0],y[1]),r.lineWidth=u.penWidth,r.lineWidth=p,r.lineCap=u.penCap,r.stroke(),r.closePath()}}}function O(r,e,t){var o,_,a,f,s,m,l,h;for(h in u.autoscale?(_=o=0,a=n(c).width(),f=n(c).height(),n.each(r,function(n,r){o=Math.max(r.mx,r.lx,o),a=Math.min(r.mx,r.lx,a),_=Math.max(r.my,r.ly,_),f=Math.min(r.my,r.ly,f)}),l=(s=(o*=1.15)-(a*=.85))/(m=(_*=1.15)-(f*=.85)),l=c.width()/c.height()<l?c.width()/s:c.height()/m,e.translate(-a*l,-f*l),e.scale.apply(e,[l,l]),e.translate((c.width()/l-s)/2,(c.height()/l-m)/2)):e.scale.apply(e,u.scale),r)"object"==typeof r[h]&&(!1===u.drawBezierCurves&&(e.beginPath(),e.moveTo(r[h].mx,r[h].my),e.lineTo(r[h].lx,r[h].ly),e.lineCap=u.penCap,e.stroke(),e.closePath()),t&&$.push({lx:r[h].lx,ly:r[h].ly,mx:r[h].mx,my:r[h].my}));!0===u.drawBezierCurves&&I(r,e)}n.extend(t,{init:function(){4.1>parseFloat((/CPU.+OS ([0-9_]{3}).*AppleWebkit.*Mobile/i.exec(navigator.userAgent)||[0,"4_2"])[1].replace("_","."))&&(n.fn.Oldoffset=n.fn.offset,n.fn.offset=function(){var r=n(this).Oldoffset();return r.top-=window.scrollY,r.left-=window.scrollX,r}),n(u.typed,o).bind("selectstart.signaturepad",function(r){return n(r.target).is(":input")}),c.bind("selectstart.signaturepad",function(r){return n(r.target).is(":input")}),!_.getContext&&FlashCanvas&&FlashCanvas.initElement(_),_.getContext&&(a=_.getContext("2d"),n(u.sig,o).show(),u.displayOnly||(u.drawOnly||(n(u.name,o).bind("keyup.signaturepad",function(){M(n(this).val())}),n(u.name,o).bind("blur.signaturepad",function(){M(n(this).val())}),n(u.drawIt,o).bind("click.signaturepad",function(n){n.preventDefault(),q()})),(u.drawOnly||"drawIt"===u.defaultAction?q:D)(),u.validateFields&&(n(r).is("form")?n(r):n(r).parents("form")).bind("submit.signaturepad",L),n(u.sigNav,o).show()))},updateOptions:function(r){n.extend(u,r)},regenerate:function(r){t.clearCanvas(),n(u.typed,o).hide(),"string"==typeof r&&(r=JSON.parse(r)),O(r,a,!0),u.output&&0<n(u.output,o).length&&n(u.output,o).val(JSON.stringify($))},clearCanvas:function(){S()},getSignature:function(){return $},getSignatureString:function(){return JSON.stringify($)},getSignatureImage:function(){var n,r=document.createElement("canvas"),e=null;return r.style.position="absolute",r.style.top="-999em",r.width=_.width,r.height=_.height,document.body.appendChild(r),!r.getContext&&FlashCanvas&&FlashCanvas.initElement(r),(e=r.getContext("2d")).fillStyle=u.bgColour,e.fillRect(0,0,_.width,_.height),e.lineWidth=u.penWidth,e.strokeStyle=u.penColour,O($,e),n=r.toDataURL.apply(r,arguments),document.body.removeChild(r),r=null,n},validateForm:L})}n.fn.signaturePad=function(e){var t=null;return this.each(function(){n.data(this,"plugin-signaturePad")?(t=n.data(this,"plugin-signaturePad")).updateOptions(e):((t=new r(this,e)).init(),n.data(this,"plugin-signaturePad",t))}),t},n.fn.signaturePad.defaults={defaultAction:"typeIt",displayOnly:!1,drawOnly:!1,canvas:"canvas",sig:".sig",sigNav:".sigNav",bgColour:"#ffffff",penColour:"#145394",penWidth:2,penCap:"round",lineColour:"#ccc",lineWidth:2,lineMargin:5,lineTop:35,name:".name",typed:".typed",clear:".clearButton",typeIt:".typeIt a",drawIt:".drawIt a",typeItDesc:".typeItDesc",drawItDesc:".drawItDesc",output:".output",currentClass:"current",validateFields:!0,errorClass:"error",errorMessage:"Please enter your name",errorMessageDraw:"Please sign the document",onBeforeValidate:null,onFormError:null,onDraw:null,onDrawEnd:null,scale:[1,1],autoscale:!1,drawBezierCurves:!1,variableStrokeWidth:!1,bezierSkip:4}}(jQuery);